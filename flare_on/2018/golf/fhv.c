/* This file has been generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2015 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

int sub_140001000();
__int64 __fastcall sub_140001030(); // weak
int sub_140001038();
void __fastcall sub_140001060(__int64 a1, const UNICODE_STRING *a2);
NTSTATUS __stdcall DriverEntry(PDRIVER_OBJECT DriverObject, PUNICODE_STRING RegistryPath);
int __fastcall sub_1400011B0(__int64 a1);
int __fastcall sub_140001228(__int64 a1);
int sub_1400012B0();
// __int64 __usercall sub_140001320@<rax>(__int64 a1@<rax>, __int64 a2@<rdx>, void (__fastcall *a3)(_QWORD, _QWORD, _QWORD)@<rcx>, __int64 a4@<r8>, __int64 a5@<r9>, __int64 a6@<r10>, __int64 a7@<r11>);
__int64 __fastcall sub_1400013E6(); // weak
// signed __int64 __usercall sub_1400014C9@<rax>(char a1@<cf>, char a2@<zf>);
void __fastcall sub_1400014E4(void *a1);
void __fastcall sub_1400014E8(void *a1);
__int16 sub_1400014F0();
__int16 sub_1400014F9();
__int16 sub_14000150A();
__int16 sub_140001512();
__int16 sub_14000151A();
__int16 sub_140001522();
void sub_140001533();
void __fastcall sub_140001536(unsigned __int64 a1);
// signed __int64 __usercall sub_14000153A@<rax>(char a1@<cf>, char a2@<zf>, __int64 _RDX@<rdx>, int _ECX@<ecx>);
// signed __int64 __usercall sub_140001557@<rax>(char a1@<cf>, char a2@<zf>, __int64 _RDX@<rdx>, int _ECX@<ecx>);
unsigned __int64 sub_140001574();
__int64 __fastcall sub_140001579(_QWORD *a1, _BYTE *a2);
__int64 __fastcall sub_140001580(_QWORD *a1, _DWORD *a2);
PBOOLEAN sub_140001588();
signed __int64 __fastcall sub_140001598(_QWORD *a1, _BYTE *a2);
signed __int64 __fastcall sub_140001608(signed __int64 *a1, char *a2);
char __fastcall sub_1400016D4(__int64 a1);
char __fastcall sub_1400016EC(__int64 a1);
char __fastcall sub_140001744(__int64 a1);
char __fastcall sub_140001780(__int64 a1);
char __fastcall sub_1400017C8(__int64 a1);
char __fastcall sub_140001818(__int64 a1);
char __fastcall sub_140001880(__int64 a1);
char __fastcall sub_1400018B0(__int64 a1);
char __fastcall sub_1400018D8(__int64 a1);
char __fastcall sub_140001900(__int64 a1);
char __fastcall sub_140001944(__int64 a1);
char __fastcall sub_14000198C(__int64 a1, char a2);
char __fastcall sub_140001A08(__int64 a1, char a2);
char __fastcall sub_140001A8C(__int64 a1, char a2);
char __fastcall sub_140001B20(__int64 a1);
char __fastcall sub_140001B48(__int64 a1);
char __fastcall sub_140001B90(__int64 a1);
char __fastcall sub_140001BE4(__int64 a1);
char __fastcall sub_140001C3C(__int64 a1);
char __fastcall sub_140001C78(__int64 a1);
char __fastcall sub_140001CB8(__int64 a1);
char __fastcall sub_140001D74(__int64 a1);
char __fastcall sub_140001E04(__int64 a1);
char __fastcall sub_140001EBC(__int64 a1);
char __fastcall sub_140001F18(__int64 a1);
char __fastcall sub_140001F74(__int64 a1);
char __fastcall sub_140001FAC(__int64 a1);
char __fastcall sub_140001FE0(__int64 a1);
char __fastcall sub_14000201C(__int64 a1);
char __fastcall sub_140002058(__int64 a1);
char __fastcall sub_140002084(_QWORD *a1);
char __fastcall sub_1400020CC(signed __int64 *a1);
char __fastcall sub_140002114(__int64 a1);
char __fastcall sub_14000216C(__int64 a1);
char __fastcall sub_140002198(__int64 a1);
char __fastcall sub_14000220C(__int64 a1);
char __fastcall sub_14000227C(__int64 a1);
char __fastcall sub_1400022C4(__int64 a1);
char __fastcall sub_140002300(__int64 a1);
char __fastcall sub_140002354(__int64 a1);
__int64 __fastcall sub_1400023AC(__int64 a1);
__int64 __fastcall sub_1400026A8(__int64 a1);
signed __int64 __fastcall sub_1400026B0(__int64 a1, unsigned __int64 a2);
signed __int64 __fastcall sub_1400026C4(__int64 a1);
void __fastcall sub_1400027C4(__int64 a1);
signed __int64 *__fastcall sub_14000280C(__int64 a1);
__int64 *__fastcall sub_140002870(__int64 a1, signed int a2, unsigned __int64 a3, __int64 a4);
void __fastcall sub_1400029E4(void *a1, int a2);
void __fastcall sub_140002A84(void *a1, signed int a2);
signed __int64 __fastcall sub_140002AE0(__int64 a1, signed int a2, unsigned __int64 a3);
__int64 __fastcall sub_140002BBC(unsigned __int64 a1);
unsigned __int64 __fastcall sub_140002C58(__int64 *a1, int a2, unsigned __int64 a3);
int __fastcall sub_140002CDC(__int64 a1);
// int MmFreeContiguousMemory(void); weak
PVOID sub_140002D28();
void sub_140002D30();
void sub_140002D70();
void __fastcall sub_140002DB0(__int16 a1, __int64 a2);
void __fastcall sub_140002DF4(__int16 a1);
char sub_140002E38();
void __fastcall sub_140002E3C(unsigned __int64 a1);
void *__fastcall sub_140002EF8(void *Source2, SIZE_T a2, const void *a3, SIZE_T a4);
// int __fastcall MmGetPhysicalAddress(_QWORD); weak
unsigned __int64 __fastcall sub_140002F78(unsigned __int64 a1);
unsigned __int64 __fastcall sub_140002F80(unsigned int a1);
int __fastcall sub_140002F8C(__int64 a1);
__int64 sub_140002F98();
__int64 __fastcall do_vmread(unsigned int a1);
// char __usercall do_vmwrite@<al>(char a1@<cf>, char a2@<zf>, __int64 _RDX@<rdx>);
unsigned __int64 __fastcall sub_140002FD8(unsigned int a1, unsigned __int64 a2);
__int64 __fastcall sub_140002FE4(); // weak
char __fastcall sub_14000302C(__int64 a1);
__int64 __fastcall sub_1400030B8(__int64 a1);
char __fastcall sub_1400030E4(__int64 a1);
char __fastcall sub_140003144(__int64 a1);
char __fastcall sub_1400032F4(__int64 a1);
void __fastcall sub_1400033A8(__int64 a1);
char __fastcall sub_14000347C(__int64 a1);
char __fastcall sub_140003634(__int64 a1);
__int64 sub_140003804();
void __fastcall VMCALL_HANDLER(__int64 a1);
void __fastcall sub_140004440(__int64 a1, _QWORD *a2);
char __fastcall sub_1400047EC(__int64 a1);
char __fastcall sub_14000481C(char a1, unsigned __int8 a2, unsigned __int8 a3, unsigned int a4);
signed __int64 __fastcall sub_140004878(unsigned int a1, __int64 a2);
__int64 __fastcall sub_140004988(void *a1, ULONG a2);
char __fastcall sub_140004A3C(__int64 a1, __int64 a2);
void __fastcall sub_140004B18(_BYTE *a1, unsigned int a2);
void __fastcall sub_140004B50(ULONG_PTR BugCheckParameter1);
signed __int64 __fastcall sub_140004B98(__int64 a1, unsigned __int64 a2, __int64 a3, __int64 a4);
void __fastcall sub_140004BB8(unsigned __int64 a1, __int64 a2, __int64 a3);
// int __fastcall KeGetProcessorNumberFromIndex(_QWORD, _QWORD); weak
// int __cdecl strcmp(const char *Str1, const char *Str2);
// int __fastcall WdfVersionUnbind(_QWORD, _QWORD, _QWORD); weak
// int __fastcall WdfVersionBind(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall WdfVersionBindClass(_QWORD, _QWORD, _QWORD); weak
// int __fastcall WdfVersionUnbindClass(_QWORD, _QWORD, _QWORD); weak
int __fastcall sub_140004C80(signed __int64 *a1, signed __int64 a2, unsigned __int64 a3);
__m128i *__fastcall sub_140004D80(char *_RCX, unsigned __int64 a2, unsigned __int64 a3);
unsigned __int64 __fastcall sub_1400050C6(__int64 a1, __int64 a2);
void sub_1400050DD();
void sub_1400050ED();
// int __fastcall KeGetCurrentProcessorNumberEx(_QWORD); weak
// PVOID __stdcall ExAllocatePoolWithTag(POOL_TYPE PoolType, SIZE_T NumberOfBytes, ULONG Tag);
// void __stdcall ExFreePoolWithTag(PVOID P, ULONG Tag);
// NTSTATUS __stdcall ExDeleteResourceLite(PERESOURCE Resource);
// PVOID __stdcall MmGetSystemRoutineAddress(PUNICODE_STRING SystemRoutineName);
// NTSTATUS __stdcall ZwClose(HANDLE Handle);
// int __fastcall ZwWaitForSingleObject(_QWORD, _QWORD, _QWORD); weak
// int __fastcall RtlGetVersion(_QWORD); weak
// SIZE_T __stdcall RtlCompareMemory(const void *Source1, const void *Source2, SIZE_T Length);
// int __fastcall KeSetSystemGroupAffinityThread(_QWORD, _QWORD); weak
// int __fastcall KeRevertToUserGroupAffinityThread(_QWORD); weak
// int __fastcall KeQueryActiveProcessorCountEx(_QWORD); weak
// PVOID __stdcall MmMapLockedPagesSpecifyCache(PMDL MemoryDescriptorList, KPROCESSOR_MODE AccessMode, MEMORY_CACHING_TYPE CacheType, PVOID BaseAddress, ULONG BugCheckOnFailure, MM_PAGE_PRIORITY Priority);
// int __fastcall MmAllocateContiguousMemory(_QWORD, _QWORD); weak
// PMDL __stdcall IoAllocateMdl(PVOID VirtualAddress, ULONG Length, BOOLEAN SecondaryBuffer, BOOLEAN ChargeQuota, PIRP Irp);
// void __stdcall IoFreeMdl(PMDL Mdl);
// int MmGetPhysicalMemoryRanges(void); weak
// int __fastcall MmGetPhysicalAddress(_QWORD); weak
// int __fastcall MmGetVirtualForPhysical(_QWORD); weak
// void __stdcall RtlInitializeBitMap(PRTL_BITMAP BitMapHeader, PULONG BitMapBuffer, ULONG SizeOfBitMap);
// void __stdcall RtlClearBits(PRTL_BITMAP BitMapHeader, ULONG StartingIndex, ULONG NumberToClear);
// void __stdcall MmProbeAndLockPages(PMDL MemoryDescriptorList, KPROCESSOR_MODE AccessMode, LOCK_OPERATION Operation);
// void __stdcall MmUnlockPages(PMDL MemoryDescriptorList);
// void __stdcall __noreturn KeBugCheckEx(ULONG BugCheckCode, ULONG_PTR BugCheckParameter1, ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter3, ULONG_PTR BugCheckParameter4);
// void __stdcall RtlCopyUnicodeString(PUNICODE_STRING DestinationString, PCUNICODE_STRING SourceString);
// void __stdcall RtlInitUnicodeString(PUNICODE_STRING DestinationString, PCWSTR SourceString);
void sub_14000B000();
void sub_14000B0C4();
signed __int64 *sub_14000B0DC();
void sub_14000B330();
bool sub_14000B5A4();
void sub_14000B5EC();
void __fastcall sub_14000B624(int (__fastcall *a1)(__int64), __int64 a2);
PVOID __fastcall sub_14000B6EC(PCWSTR SourceString);
void sub_14000B71C();
void sub_14000B73C();
void sub_14000B81C();
signed __int64 *sub_14000B82C();
void __fastcall sub_14000B950(PVOID P);
int __fastcall sub_14000BA08(unsigned __int16 a1);
unsigned __int64 __fastcall sub_14000BA30(__int64 a1, unsigned __int16 a2);
unsigned __int64 __fastcall sub_14000BA8C(__int64 a1);
signed __int64 *sub_14000BAC4();
void __fastcall sub_14000BBCC(__int64 a1, __int64 a2, volatile signed __int32 *a3);
__int64 sub_14000BDE0();
void __fastcall sub_14000BE30(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
// __int64 __usercall sub_14000C614@<rax>(__int64 a1@<rax>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __int64 a5@<r10>, __int64 a6@<r11>);
__int64 sub_14000C638();
void __fastcall sub_14000D000(__int64 a1);
void sub_14000D0E4();
__int64 sub_14000D14C();
void __fastcall sub_14000D180(__int64 a1);
signed __int64 sub_14000D36C();
ULONG_PTR sub_14000D49C();

//-------------------------------------------------------------------------
// Data declarations

char byte_140001377 = ''; // weak
_UNKNOWN loc_140001500; // weak
char byte_140001528[6] = { 'é', 'Ã', 'f', 'Œ', 'è', 'Ã' }; // weak
__int16 word_14000152E = 3912; // weak
_UNKNOWN loc_140004528; // weak
_UNKNOWN loc_140004D3D; // weak
// extern PBOOLEAN KdDebuggerNotPresent;
_UNKNOWN unk_140006148; // weak
_UNKNOWN unk_140006150; // weak
__int64 qword_140007000 = -9914969829376i64; // weak
__int64 qword_140007008 = -9914971848704i64; // weak
__int64 qword_140007010 = -9916005744640i64; // weak
__int64 qword_140007018 = -10445360463872i64; // weak
ULONG_PTR _security_cookie = 47936899621426ui64; // idb
ULONG_PTR BugCheckParameter3 = 18446696136809930189ui64; // idb
_UNKNOWN unk_140007030; // weak
_UNKNOWN unk_140007060; // weak
_UNKNOWN unk_140007070; // weak
void *off_140007078 = &unk_140007060; // weak
_UNKNOWN unk_140007090; // weak
_UNKNOWN unk_1400070A0; // weak
_UNKNOWN unk_1400070B0; // weak
int dword_1400072E0; // weak
int dword_140007308; // weak
int dword_14000730C; // weak
_UNKNOWN unk_140007330; // weak
_UNKNOWN unk_140007331; // weak
char byte_140008C20; // weak
__int64 qword_140008C28; // weak
__int64 qword_140008C30; // weak
__int64 qword_140008C38; // weak
PVOID P; // idb
int (__fastcall *qword_140008C48)(_QWORD, _QWORD, _QWORD, _QWORD); // weak
__int64 qword_140008C50; // weak
__int64 qword_140008C58; // weak
__int64 qword_140008C60; // weak
__int64 qword_140008C68; // weak
__int64 qword_140008C70; // weak
__int64 qword_140008C78; // weak
__int64 qword_140008C80; // weak
__int64 qword_140008C88; // weak
__int64 qword_140008C90; // weak
__int64 qword_140008C98; // weak
__int64 qword_140008CA0; // weak
__int64 qword_140008CA8; // weak
int dword_140008CB0; // weak
PMDL MemoryDescriptorList; // idb
__int64 qword_140009308; // weak
UNICODE_STRING DestinationString; // idb
int (*qword_140009938)(void); // weak
__int64 qword_140009940; // weak
__int64 qword_140009948; // weak
__int64 qword_140009950; // weak
_UNKNOWN unk_140009960; // weak


//----- (0000000140001000) ----------------------------------------------------
int sub_140001000()
{
  sub_1400011B0((__int64)&unk_140007030);
  return WdfVersionUnbind(&DestinationString, &unk_140007030, qword_140009948);
}
// 140004C36: using guessed type int __fastcall WdfVersionUnbind(_QWORD, _QWORD, _QWORD);
// 140009948: using guessed type __int64 qword_140009948;

//----- (0000000140001038) ----------------------------------------------------
int sub_140001038()
{
  if ( qword_140009938 && (char *)qword_140009938 != (char *)sub_140001038 )
    qword_140009938();
  return sub_140001000();
}
// 140009938: using guessed type int (*qword_140009938)(void);

//----- (0000000140001060) ----------------------------------------------------
void __fastcall sub_140001060(__int64 a1, const UNICODE_STRING *a2)
{
  __int64 v2; // rdi@1
  int v3; // eax@5
  int (*v4)(void); // rax@7

  v2 = a1;
  if ( a1 )
  {
    qword_140009950 = a1;
    DestinationString.MaximumLength = 520;
    DestinationString.Length = 0;
    DestinationString.Buffer = (PWSTR)&unk_140009960;
    RtlCopyUnicodeString(&DestinationString, a2);
    if ( WdfVersionBind(v2, &DestinationString, &unk_140007030, &qword_140009948) >= 0 )
    {
      if ( sub_140001228((__int64)&unk_140007030) < 0 || (sub_1400012B0(), sub_14000D000(v2), v3 < 0) )
      {
        sub_140001000();
      }
      else if ( *(_BYTE *)(qword_140009948 + 48) )
      {
        v4 = qword_140009938;
        if ( *(_QWORD *)(v2 + 104) )
          v4 = *(int (**)(void))(v2 + 104);
        qword_140009938 = v4;
        *(_QWORD *)(v2 + 104) = sub_140001038;
      }
      else if ( *(_BYTE *)(qword_140009948 + 8) & 2 )
      {
        qword_140009940 = qword_140009308;
        qword_140009308 = (__int64)sub_140001030;
      }
    }
  }
  else
  {
    sub_14000D000(0i64);
  }
}
// 140001030: using guessed type __int64 __fastcall sub_140001030();
// 140004C3C: using guessed type int __fastcall WdfVersionBind(_QWORD, _QWORD, _QWORD, _QWORD);
// 140009308: using guessed type __int64 qword_140009308;
// 140009938: using guessed type int (*qword_140009938)(void);
// 140009940: using guessed type __int64 qword_140009940;
// 140009948: using guessed type __int64 qword_140009948;
// 140009950: using guessed type __int64 qword_140009950;

//----- (0000000140001184) ----------------------------------------------------
NTSTATUS __stdcall DriverEntry(PDRIVER_OBJECT DriverObject, PUNICODE_STRING RegistryPath)
{
  const UNICODE_STRING *v2; // rbx@1
  PDRIVER_OBJECT v3; // rdi@1
  NTSTATUS result; // eax@1

  v2 = RegistryPath;
  v3 = DriverObject;
  sub_14000D49C();
  sub_140001060((__int64)v3, v2);
  return result;
}

//----- (00000001400011B0) ----------------------------------------------------
int __fastcall sub_1400011B0(__int64 a1)
{
  int result; // eax@1
  __int64 v2; // rdi@1
  void *v3; // rbx@1
  int (__fastcall *v4)(int (__fastcall *)(_QWORD, _QWORD, _QWORD), __int64, __int64, void *); // rax@3

  result = (signed int)off_140007078;
  v2 = a1;
  v3 = &unk_140007070;
  if ( off_140007078 != &unk_140007060 && &unk_140007070 <= off_140007078 )
  {
    do
    {
      v4 = (int (__fastcall *)(int (__fastcall *)(_QWORD, _QWORD, _QWORD), __int64, __int64, void *))*((_QWORD *)v3 + 8);
      if ( v4 )
        result = v4(WdfVersionUnbindClass, v2, qword_140009948, v3);
      else
        result = WdfVersionUnbindClass(v2, qword_140009948, v3);
      v3 = (char *)v3 + 80;
    }
    while ( v3 <= off_140007078 );
  }
  return result;
}
// 140004C48: using guessed type int __fastcall WdfVersionUnbindClass(_QWORD, _QWORD, _QWORD);
// 140007078: using guessed type void *off_140007078;
// 140009948: using guessed type __int64 qword_140009948;

//----- (0000000140001228) ----------------------------------------------------
int __fastcall sub_140001228(__int64 a1)
{
  __int64 v1; // rdi@1
  int result; // eax@1
  void *i; // rbx@1
  int (__fastcall *v4)(int (__fastcall *)(_QWORD, _QWORD, _QWORD), __int64, __int64, void *); // rax@4

  v1 = a1;
  result = 0;
  for ( i = &unk_140007070; i < &unk_140007070; i = (char *)i + 80 )
  {
    if ( *(_DWORD *)i != 80 )
      return -1073741820;
    v4 = (int (__fastcall *)(int (__fastcall *)(_QWORD, _QWORD, _QWORD), __int64, __int64, void *))*((_QWORD *)i + 7);
    off_140007078 = i;
    if ( v4 )
      result = v4(WdfVersionBindClass, v1, qword_140009948, i);
    else
      result = WdfVersionBindClass(v1, qword_140009948, i);
    if ( result < 0 )
      return result;
  }
  return result;
}
// 140004C42: using guessed type int __fastcall WdfVersionBindClass(_QWORD, _QWORD, _QWORD);
// 140007078: using guessed type void *off_140007078;
// 140009948: using guessed type __int64 qword_140009948;

//----- (00000001400012B0) ----------------------------------------------------
int sub_1400012B0()
{
  int (*v0)(void); // rax@1
  int (**v1)(void); // rbx@2
  signed __int64 v2; // rdi@2

  v0 = (int (*)(void))&unk_140007090;
  if ( &unk_140007090 < &unk_140007090 )
  {
    v1 = (int (**)(void))&unk_1400070B0;
    v2 = 1i64;
    do
    {
      v0 = *v1;
      if ( *v1 )
      {
        LODWORD(v0) = v0();
        *(v1 - 1) = v0;
      }
      v1 += 5;
      --v2;
    }
    while ( v2 );
  }
  return (unsigned __int64)v0;
}

//----- (0000000140001320) ----------------------------------------------------
__int64 __usercall sub_140001320@<rax>(__int64 a1@<rax>, __int64 a2@<rdx>, void (__fastcall *a3)(_QWORD, _QWORD, _QWORD)@<rcx>, __int64 a4@<r8>, __int64 a5@<r9>, __int64 a6@<r10>, __int64 a7@<r11>)
{
  unsigned __int64 v7; // rt0@1
  __int64 v9; // [sp-88h] [bp-88h]@1
  __int64 v10; // [sp-68h] [bp-68h]@1
  __int64 v11; // [sp-60h] [bp-60h]@1
  __int64 v12; // [sp-58h] [bp-58h]@1
  __int64 v13; // [sp-50h] [bp-50h]@1
  signed __int64 v14; // [sp-30h] [bp-30h]@1
  __int64 v15; // [sp-20h] [bp-20h]@1
  void (__fastcall *v16)(_QWORD, _QWORD, _QWORD); // [sp-18h] [bp-18h]@1
  __int64 v17; // [sp-10h] [bp-10h]@1
  unsigned __int64 v18; // [sp-8h] [bp-8h]@1

  v7 = __getcallerseflags();
  v18 = v7;
  v17 = a1;
  v16 = a3;
  v15 = a2;
  v14 = -1i64;
  v13 = a4;
  v12 = a5;
  v11 = a6;
  v10 = a7;
  a3(&v9, &byte_140001377, a2);
  __writeeflags(v18);
  return 0i64;
}
// 140001377: using guessed type char byte_140001377;

//----- (00000001400014C9) ----------------------------------------------------
signed __int64 __usercall sub_1400014C9@<rax>(char a1@<cf>, char a2@<zf>)
{
  signed __int64 result; // rax@3

  __asm { vmcall }
  if ( a2 )
  {
    result = 1i64;
  }
  else if ( a1 )
  {
    result = 2i64;
  }
  else
  {
    result = 0i64;
  }
  return result;
}

//----- (00000001400014E4) ----------------------------------------------------
void __fastcall sub_1400014E4(void *a1)
{
  __lgdt(a1);
}

//----- (00000001400014E8) ----------------------------------------------------
void __fastcall sub_1400014E8(void *a1)
{
  __sgdt(a1);
}

//----- (00000001400014F0) ----------------------------------------------------
__int16 sub_1400014F0()
{
  __int16 result; // ax@1

  __asm { sldt    ax }
  return result;
}

//----- (00000001400014F9) ----------------------------------------------------
__int16 sub_1400014F9()
{
  __int16 result; // ax@1

  __asm { str     ax }
  return result;
}

//----- (000000014000150A) ----------------------------------------------------
__int16 sub_14000150A()
{
  return __CS__;
}

//----- (0000000140001512) ----------------------------------------------------
__int16 sub_140001512()
{
  return __SS__;
}

//----- (000000014000151A) ----------------------------------------------------
__int16 sub_14000151A()
{
  return __DS__;
}

//----- (0000000140001522) ----------------------------------------------------
__int16 sub_140001522()
{
  return __FS__;
}

//----- (0000000140001533) ----------------------------------------------------
void sub_140001533()
{
  __asm { invd }
}

//----- (0000000140001536) ----------------------------------------------------
void __fastcall sub_140001536(unsigned __int64 a1)
{
  __writecr2(a1);
}

//----- (000000014000153A) ----------------------------------------------------
signed __int64 __usercall sub_14000153A@<rax>(char a1@<cf>, char a2@<zf>, __int64 _RDX@<rdx>, int _ECX@<ecx>)
{
  signed __int64 result; // rax@3

  __asm { invept  ecx, xmmword ptr [rdx] }
  if ( a2 )
  {
    result = 1i64;
  }
  else if ( a1 )
  {
    result = 2i64;
  }
  else
  {
    result = 0i64;
  }
  return result;
}

//----- (0000000140001557) ----------------------------------------------------
signed __int64 __usercall sub_140001557@<rax>(char a1@<cf>, char a2@<zf>, __int64 _RDX@<rdx>, int _ECX@<ecx>)
{
  signed __int64 result; // rax@3

  __asm { invvpid ecx, xmmword ptr [rdx] }
  if ( a2 )
  {
    result = 1i64;
  }
  else if ( a1 )
  {
    result = 2i64;
  }
  else
  {
    result = 0i64;
  }
  return result;
}

//----- (0000000140001574) ----------------------------------------------------
unsigned __int64 sub_140001574()
{
  return __readeflags();
}

//----- (0000000140001579) ----------------------------------------------------
__int64 __fastcall sub_140001579(_QWORD *a1, _BYTE *a2)
{
  __int64 result; // rax@1

  result = *a2;
  *a1 = result;
  return result;
}

//----- (0000000140001580) ----------------------------------------------------
__int64 __fastcall sub_140001580(_QWORD *a1, _DWORD *a2)
{
  __int64 result; // rax@1

  result = *a2;
  *a1 = result;
  return result;
}

//----- (0000000140001588) ----------------------------------------------------
PBOOLEAN sub_140001588()
{
  PBOOLEAN result; // rax@1

  result = KdDebuggerNotPresent;
  if ( !(_BYTE)KdDebuggerNotPresent )
    __debugbreak();
  return result;
}

//----- (0000000140001598) ----------------------------------------------------
signed __int64 __fastcall sub_140001598(_QWORD *a1, _BYTE *a2)
{
  char v2; // al@1
  signed __int64 result; // rax@2

  v2 = *a2 + 9;
  if ( *a2 == -21 )
  {
    result = (signed __int64)(a1 + 2);
  }
  else
  {
    switch ( v2 )
    {
      case -18:
        result = *a1 + 120i64;
        break;
      case -17:
        result = *a1 + 96i64;
        break;
      case -16:
        result = *a1 + 112i64;
        break;
      case -15:
        result = *a1 + 104i64;
        break;
      case -14:
        result = *a1 + 72i64;
        break;
      case -13:
        result = *a1 + 64i64;
        break;
      case -11:
        result = *a1 + 88i64;
        break;
      case -10:
        result = *a1 + 80i64;
        break;
      default:
        result = 0i64;
        break;
    }
  }
  return result;
}

//----- (0000000140001608) ----------------------------------------------------
signed __int64 __fastcall sub_140001608(signed __int64 *a1, char *a2)
{
  char v2; // al@1
  signed __int64 result; // rax@2

  v2 = *a2;
  if ( *a2 == -12 )
  {
    result = (signed __int64)(a1 + 2);
  }
  else
  {
    switch ( v2 )
    {
      case -18:
        result = *a1 + 120;
        break;
      case -17:
        result = *a1 + 96;
        break;
      case -16:
        result = *a1 + 112;
        break;
      case -15:
        result = *a1 + 104;
        break;
      case -14:
        result = *a1 + 72;
        break;
      case -13:
        result = *a1 + 64;
        break;
      case -11:
        result = *a1 + 88;
        break;
      case -10:
        result = *a1 + 80;
        break;
      case -9:
        result = *a1 + 56;
        break;
      case -8:
        result = *a1 + 48;
        break;
      case -7:
        result = *a1 + 40;
        break;
      case -6:
        result = *a1 + 32;
        break;
      case -5:
        result = *a1 + 24;
        break;
      case -4:
        result = *a1 + 16;
        break;
      case -3:
        result = *a1 + 8;
        break;
      case -2:
        result = *a1;
        break;
      default:
        result = 0i64;
        break;
    }
  }
  return result;
}

//----- (00000001400016D4) ----------------------------------------------------
char __fastcall sub_1400016D4(__int64 a1)
{
  __int64 v1; // rax@1

  v1 = *(_QWORD *)(a1 + 16);
  return do_vmwrite(__CFADD__(v1, *(_WORD *)(v1 + 1)), v1 + *(_WORD *)(v1 + 1) == 0, v1 + *(_WORD *)(v1 + 1));
}

//----- (00000001400016EC) ----------------------------------------------------
char __fastcall sub_1400016EC(__int64 a1)
{
  __int64 v1; // rdi@1
  __int64 v2; // rsi@1
  _QWORD *v3; // rbx@1
  char v5; // [sp+0h] [bp-28h]@1
  __int64 v6; // [sp+20h] [bp-8h]@1

  v1 = *(_QWORD *)(a1 + 16);
  v2 = a1;
  v3 = (_QWORD *)sub_140001608((signed __int64 *)a1, (char *)(v1 + 2));
  *v3 += *(_QWORD *)sub_140001608((signed __int64 *)v2, (char *)(v1 + 1));
  return do_vmwrite(__CFADD__(&v5, 32i64), &v6 == 0i64, *(_QWORD *)(v2 + 16) + 3i64);
}

//----- (0000000140001744) ----------------------------------------------------
char __fastcall sub_140001744(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rdi@1
  _DWORD *v3; // rax@1
  char v5; // [sp+0h] [bp-28h]@1
  __int64 v6; // [sp+20h] [bp-8h]@1

  v1 = *(_QWORD *)(a1 + 16);
  v2 = a1;
  v3 = (_DWORD *)sub_140001598((_QWORD *)a1, (_BYTE *)(v1 + 1));
  *v3 &= *(_DWORD *)(v1 + 2);
  return do_vmwrite(__CFADD__(&v5, 32i64), &v6 == 0i64, *(_QWORD *)(v2 + 16) + 6i64);
}

//----- (0000000140001780) ----------------------------------------------------
char __fastcall sub_140001780(__int64 a1)
{
  __int64 v1; // rdx@1
  __int64 v2; // rbx@1
  __int64 v3; // rax@1
  __int64 v4; // rcx@1
  __int64 v5; // rdx@1
  __int64 v6; // rcx@1
  __int64 v7; // rax@1
  char v8; // cf@1
  char v9; // zf@1
  char v11; // [sp+0h] [bp-28h]@1
  __int64 v12; // [sp+20h] [bp-8h]@1

  v1 = *(_QWORD *)(a1 + 16);
  v2 = a1;
  v3 = *(_QWORD *)a1;
  v4 = *(_DWORD *)(v1 + 1);
  v5 = *(_DWORD *)(v1 + 5);
  v6 = *(_DWORD *)(*(_QWORD *)(v3 + 88) + v4);
  v7 = sub_140001574();
  do_vmwrite(v8, v9, v7);
  return do_vmwrite(__CFADD__(&v11, 32i64), &v12 == 0i64, *(_QWORD *)(v2 + 16) + 9i64);
}

//----- (00000001400017C8) ----------------------------------------------------
char __fastcall sub_1400017C8(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rdi@1
  _DWORD *v3; // rax@1
  __int64 v4; // rdx@1
  __int64 v5; // rcx@1
  __int64 v6; // rax@1
  char v7; // cf@1
  char v8; // zf@1
  char v10; // [sp+0h] [bp-28h]@1
  __int64 v11; // [sp+20h] [bp-8h]@1

  v1 = *(_QWORD *)(a1 + 16);
  v2 = a1;
  v3 = (_DWORD *)sub_140001598((_QWORD *)a1, (_BYTE *)(v1 + 1));
  v4 = *(_DWORD *)(v1 + 2);
  v5 = *v3;
  v6 = sub_140001574();
  do_vmwrite(v7, v8, v6);
  return do_vmwrite(__CFADD__(&v10, 32i64), &v11 == 0i64, *(_QWORD *)(v2 + 16) + 6i64);
}

//----- (0000000140001818) ----------------------------------------------------
char __fastcall sub_140001818(__int64 a1)
{
  __int64 v1; // rdi@1
  __int64 v2; // rsi@1
  _DWORD *v3; // rbx@1
  _DWORD *v4; // rax@1
  __int64 v5; // rcx@1
  __int64 v6; // rdx@1
  __int64 v7; // rax@1
  char v8; // cf@1
  char v9; // zf@1
  char v11; // [sp+0h] [bp-28h]@1
  __int64 v12; // [sp+20h] [bp-8h]@1

  v1 = *(_QWORD *)(a1 + 16);
  v2 = a1;
  v3 = (_DWORD *)sub_140001598((_QWORD *)a1, (_BYTE *)(v1 + 1));
  v4 = (_DWORD *)sub_140001598((_QWORD *)v2, (_BYTE *)(v1 + 2));
  v5 = *v3;
  v6 = *v4;
  v7 = sub_140001574();
  do_vmwrite(v8, v9, v7);
  return do_vmwrite(__CFADD__(&v11, 32i64), &v12 == 0i64, *(_QWORD *)(v2 + 16) + 3i64);
}

//----- (0000000140001880) ----------------------------------------------------
char __fastcall sub_140001880(__int64 a1)
{
  unsigned __int64 v1; // rdx@1
  __int64 v2; // r8@1
  char v3; // cf@2
  bool v4; // zf@2
  __int64 v5; // rdx@3
  __int64 v6; // rdx@4

  v1 = *(_QWORD *)(a1 + 8);
  v2 = *(_QWORD *)(a1 + 16);
  if ( v1 & 0x40 || (v3 = 0, v4 = (_BYTE)v1 == v1 >> 4, ((v1 ^ (v1 >> 4)) & 0x80u) == 0i64) )
  {
    v6 = *(_WORD *)(v2 + 1);
    v3 = __CFADD__(v2, v6);
    v4 = v2 + v6 == 0;
    v5 = v2 + v6;
  }
  else
  {
    v5 = v2 + 3;
  }
  return do_vmwrite(v3, v4, v5);
}

//----- (00000001400018B0) ----------------------------------------------------
char __fastcall sub_1400018B0(__int64 a1)
{
  __int64 v1; // rax@2
  __int64 v2; // rdx@2
  char v3; // cf@2
  bool v4; // zf@2
  __int64 v5; // rdx@2
  __int64 v6; // rdx@3

  if ( *(_BYTE *)(a1 + 8) & 0x40 )
  {
    v6 = *(_QWORD *)(a1 + 16);
    v3 = __CFADD__(v6, 3i64);
    v4 = v6 == -3;
    v5 = v6 + 3;
  }
  else
  {
    v1 = *(_QWORD *)(a1 + 16);
    v2 = *(_WORD *)(v1 + 1);
    v3 = __CFADD__(v1, v2);
    v4 = v1 + v2 == 0;
    v5 = v1 + v2;
  }
  return do_vmwrite(v3, v4, v5);
}

//----- (00000001400018D8) ----------------------------------------------------
char __fastcall sub_1400018D8(__int64 a1)
{
  __int64 v1; // rax@2
  __int64 v2; // rdx@2
  char v3; // cf@2
  bool v4; // zf@2
  __int64 v5; // rdx@2
  __int64 v6; // rdx@3

  if ( *(_BYTE *)(a1 + 8) & 0x40 )
  {
    v1 = *(_QWORD *)(a1 + 16);
    v2 = *(_WORD *)(v1 + 1);
    v3 = __CFADD__(v1, v2);
    v4 = v1 + v2 == 0;
    v5 = v1 + v2;
  }
  else
  {
    v6 = *(_QWORD *)(a1 + 16);
    v3 = __CFADD__(v6, 3i64);
    v4 = v6 == -3;
    v5 = v6 + 3;
  }
  return do_vmwrite(v3, v4, v5);
}

//----- (0000000140001900) ----------------------------------------------------
char __fastcall sub_140001900(__int64 a1)
{
  __int64 v1; // rbx@1
  char v3; // [sp+0h] [bp-28h]@1
  __int64 v4; // [sp+20h] [bp-8h]@1

  v1 = *(_QWORD *)(a1 + 16);
  *(_QWORD *)sub_140001608((signed __int64 *)a1, (char *)(v1 + 1)) = *(_QWORD *)(*(_QWORD *)a1 + 88i64)
                                                                   + *(_DWORD *)(v1 + 2);
  return do_vmwrite(__CFADD__(&v3, 32i64), &v4 == 0i64, *(_QWORD *)(a1 + 16) + 6i64);
}

//----- (0000000140001944) ----------------------------------------------------
char __fastcall sub_140001944(__int64 a1)
{
  __int64 v1; // rbx@1
  char v3; // [sp+0h] [bp-28h]@1
  __int64 v4; // [sp+20h] [bp-8h]@1

  v1 = *(_QWORD *)(a1 + 16);
  *(_DWORD *)sub_140001598((_QWORD *)a1, (_BYTE *)(v1 + 1)) = *(_DWORD *)(*(_DWORD *)(v1 + 2)
                                                                        + *(_QWORD *)(*(_QWORD *)a1 + 88i64));
  return do_vmwrite(__CFADD__(&v3, 32i64), &v4 == 0i64, *(_QWORD *)(a1 + 16) + 6i64);
}

//----- (000000014000198C) ----------------------------------------------------
char __fastcall sub_14000198C(__int64 a1, char a2)
{
  __int64 v2; // rsi@1
  char v3; // bl@1
  __int64 v4; // r14@1
  int *v5; // rax@1
  int *v6; // rdi@1
  int v7; // ebx@2
  unsigned __int64 v8; // rax@4
  char v10; // [sp+0h] [bp-28h]@6
  __int64 v11; // [sp+20h] [bp-8h]@6

  v2 = *(_QWORD *)(a1 + 16);
  v3 = a2;
  v4 = a1;
  v5 = (int *)sub_140001598((_QWORD *)a1, (_BYTE *)(v2 + 1));
  v6 = v5;
  if ( v3 )
    v7 = *v5 + *(_DWORD *)(v2 + 2);
  else
    v7 = *v5 - *(_DWORD *)(v2 + 2);
  v8 = *(_QWORD *)v4 + 88i64;
  if ( v6 == (int *)v8 )
    do_vmwrite((unsigned __int64)v6 < v8, v6 == (int *)v8, v7);
  *v6 = v7;
  return do_vmwrite(__CFADD__(&v10, 32i64), &v11 == 0i64, *(_QWORD *)(v4 + 16) + 6i64);
}

//----- (0000000140001A08) ----------------------------------------------------
char __fastcall sub_140001A08(__int64 a1, char a2)
{
  __int64 v2; // rsi@1
  char v3; // bl@1
  __int64 v4; // r14@1
  __int64 *v5; // rax@1
  __int64 *v6; // rdi@1
  __int64 v7; // rbx@2
  unsigned __int64 v8; // rax@4
  char v10; // [sp+0h] [bp-28h]@6
  __int64 v11; // [sp+20h] [bp-8h]@6

  v2 = *(_QWORD *)(a1 + 16);
  v3 = a2;
  v4 = a1;
  v5 = (__int64 *)sub_140001608((signed __int64 *)a1, (char *)(v2 + 1));
  v6 = v5;
  if ( v3 )
    v7 = *v5 + *(_DWORD *)(v2 + 2);
  else
    v7 = *v5 - *(_DWORD *)(v2 + 2);
  v8 = *(_QWORD *)v4 + 88i64;
  if ( v6 == (__int64 *)v8 )
    do_vmwrite((unsigned __int64)v6 < v8, v6 == (__int64 *)v8, v7);
  *v6 = v7;
  return do_vmwrite(__CFADD__(&v10, 32i64), &v11 == 0i64, *(_QWORD *)(v4 + 16) + 6i64);
}

//----- (0000000140001A8C) ----------------------------------------------------
char __fastcall sub_140001A8C(__int64 a1, char a2)
{
  __int64 v2; // rbx@1
  char v3; // di@1
  __int64 v4; // r14@1
  _DWORD *v5; // r15@1
  int *v6; // rsi@1
  int v7; // ebx@1
  int v8; // ebx@2
  unsigned __int64 v9; // rax@4
  char v11; // [sp+0h] [bp-28h]@6
  __int64 v12; // [sp+20h] [bp-8h]@6

  v2 = *(_QWORD *)(a1 + 16);
  v3 = a2;
  v4 = a1;
  v5 = (_DWORD *)sub_140001598((_QWORD *)a1, (_BYTE *)(v2 + 1));
  v6 = (int *)sub_140001598((_QWORD *)v4, (_BYTE *)(v2 + 2));
  v7 = *v6;
  if ( v3 )
    v8 = *v5 + v7;
  else
    v8 = v7 - *v5;
  v9 = *(_QWORD *)v4 + 88i64;
  if ( v6 == (int *)v9 )
    do_vmwrite((unsigned __int64)v6 < v9, v6 == (int *)v9, (unsigned int)v8);
  *v6 = v8;
  return do_vmwrite(__CFADD__(&v11, 32i64), &v12 == 0i64, *(_QWORD *)(v4 + 16) + 3i64);
}

//----- (0000000140001B20) ----------------------------------------------------
char __fastcall sub_140001B20(__int64 a1)
{
  *(_BYTE *)(*(_QWORD *)a1 + 120i64) = *(_BYTE *)(*(_DWORD *)(*(_QWORD *)(a1 + 16) + 1i64)
                                                + *(_QWORD *)(*(_QWORD *)a1 + 88i64));
  return do_vmwrite(
           __CFADD__(*(_QWORD *)(a1 + 16), 5i64),
           *(_QWORD *)(a1 + 16) == -5i64,
           *(_QWORD *)(a1 + 16) + 5i64);
}

//----- (0000000140001B48) ----------------------------------------------------
char __fastcall sub_140001B48(__int64 a1)
{
  __int64 v1; // rbx@1
  char v3; // [sp+0h] [bp-28h]@1
  __int64 v4; // [sp+20h] [bp-8h]@1

  v1 = *(_QWORD *)(a1 + 16);
  *(_QWORD *)sub_140001608((signed __int64 *)a1, (char *)(v1 + 1)) = *(_QWORD *)(*(_DWORD *)(v1 + 2)
                                                                               + *(_QWORD *)(*(_QWORD *)a1 + 88i64));
  return do_vmwrite(__CFADD__(&v3, 32i64), &v4 == 0i64, *(_QWORD *)(a1 + 16) + 6i64);
}

//----- (0000000140001B90) ----------------------------------------------------
char __fastcall sub_140001B90(__int64 a1)
{
  __int64 v1; // rdi@1
  __int64 v2; // rsi@1
  _DWORD *v3; // rbx@1
  char v5; // [sp+0h] [bp-28h]@1
  __int64 v6; // [sp+20h] [bp-8h]@1

  v1 = *(_QWORD *)(a1 + 16);
  v2 = a1;
  v3 = (_DWORD *)sub_140001598((_QWORD *)a1, (_BYTE *)(v1 + 2));
  *v3 = *(_DWORD *)sub_140001598((_QWORD *)v2, (_BYTE *)(v1 + 1));
  return do_vmwrite(__CFADD__(&v5, 32i64), &v6 == 0i64, *(_QWORD *)(v2 + 16) + 3i64);
}

//----- (0000000140001BE4) ----------------------------------------------------
char __fastcall sub_140001BE4(__int64 a1)
{
  __int64 v1; // rdi@1
  __int64 v2; // rsi@1
  _QWORD *v3; // rbx@1
  char v5; // [sp+0h] [bp-28h]@1
  __int64 v6; // [sp+20h] [bp-8h]@1

  v1 = *(_QWORD *)(a1 + 16);
  v2 = a1;
  v3 = (_QWORD *)sub_140001608((signed __int64 *)a1, (char *)(v1 + 2));
  *v3 = *(_QWORD *)sub_140001608((signed __int64 *)v2, (char *)(v1 + 1));
  return do_vmwrite(__CFADD__(&v5, 32i64), &v6 == 0i64, *(_QWORD *)(v2 + 16) + 3i64);
}

//----- (0000000140001C3C) ----------------------------------------------------
char __fastcall sub_140001C3C(__int64 a1)
{
  __int64 v1; // rbx@1
  char v3; // [sp+0h] [bp-28h]@1
  __int64 v4; // [sp+20h] [bp-8h]@1

  v1 = *(_QWORD *)(a1 + 16);
  *(_DWORD *)sub_140001598((_QWORD *)a1, (_BYTE *)(v1 + 1)) = *(_DWORD *)(v1 + 2);
  return do_vmwrite(__CFADD__(&v3, 32i64), &v4 == 0i64, *(_QWORD *)(a1 + 16) + 6i64);
}

//----- (0000000140001C78) ----------------------------------------------------
char __fastcall sub_140001C78(__int64 a1)
{
  __int64 v1; // rbx@1
  char v3; // [sp+0h] [bp-28h]@1
  __int64 v4; // [sp+20h] [bp-8h]@1

  v1 = *(_QWORD *)(a1 + 16);
  *(_QWORD *)sub_140001598((_QWORD *)a1, (_BYTE *)(v1 + 1)) = *(_QWORD *)(v1 + 2);
  return do_vmwrite(__CFADD__(&v3, 32i64), &v4 == 0i64, *(_QWORD *)(a1 + 16) + 10i64);
}

//----- (0000000140001CB8) ----------------------------------------------------
char __fastcall sub_140001CB8(__int64 a1)
{
  __int64 v1; // r13@1
  unsigned int v2; // esi@1
  __int64 v3; // rbx@1
  signed int v4; // ebp@1
  signed __int64 v5; // rdi@1
  _QWORD *v6; // r15@1
  char *v7; // r14@1
  _DWORD *v8; // rax@2
  __int64 v9; // rdx@5
  char v11; // [sp+0h] [bp-38h]@7
  __int64 v12; // [sp+20h] [bp-18h]@7

  v1 = *(_QWORD *)(a1 + 16);
  v2 = 0;
  v3 = a1;
  v4 = 6;
  v5 = v1 + 1;
  v6 = (_QWORD *)sub_140001598((_QWORD *)a1, (_BYTE *)(v1 + 1));
  v7 = (char *)(v1 + 2);
  while ( sub_140001608((signed __int64 *)v3, v7) )
  {
    v8 = (_DWORD *)sub_140001608((signed __int64 *)v3, v7);
    ++v5;
    ++v7;
    v2 += *v8;
    ++v4;
  }
  if ( *(_BYTE *)v1 == 31 )
    v9 = *(_DWORD *)(v5 + 1);
  else
    v9 = *(_DWORD *)(v5 + 1) + *(_QWORD *)(*(_QWORD *)v3 + 88i64);
  sub_140001579(v6, (_BYTE *)(v2 + v9));
  return do_vmwrite(__CFADD__(&v11, 32i64), &v12 == 0i64, *(_QWORD *)(v3 + 16) + (unsigned int)v4);
}

//----- (0000000140001D74) ----------------------------------------------------
char __fastcall sub_140001D74(__int64 a1)
{
  __int64 v1; // rdi@1
  signed __int64 v2; // rbx@1
  signed int v3; // ebp@1
  _QWORD *v4; // r14@1
  char *i; // rsi@1
  char v7; // [sp+0h] [bp-28h]@4
  __int64 v8; // [sp+20h] [bp-8h]@4

  v1 = a1;
  v2 = *(_QWORD *)(a1 + 16) + 1i64;
  v3 = 6;
  v4 = (_QWORD *)sub_140001608((signed __int64 *)a1, (char *)v2);
  for ( i = (char *)(v2 + 1); sub_140001608((signed __int64 *)v1, i); ++i )
  {
    ++v3;
    v2 = (signed __int64)i;
  }
  sub_140001580(v4, (_DWORD *)(*(_QWORD *)(*(_QWORD *)v1 + 88i64) + *(_DWORD *)(v2 + 1)));
  return do_vmwrite(__CFADD__(&v7, 32i64), &v8 == 0i64, *(_QWORD *)(v1 + 16) + (unsigned int)v3);
}

//----- (0000000140001E04) ----------------------------------------------------
char __fastcall sub_140001E04(__int64 a1)
{
  __int64 v1; // r13@1
  __int64 v2; // rbp@1
  __int64 v3; // rbx@1
  signed __int64 v4; // rdi@1
  signed int v5; // er14@1
  _DWORD *v6; // rsi@1
  char *v7; // r15@1
  _DWORD *v8; // rax@2
  int v9; // ecx@5
  char v11; // [sp+0h] [bp-38h]@7
  __int64 v12; // [sp+20h] [bp-18h]@7

  v1 = *(_QWORD *)(a1 + 16);
  v2 = 0i64;
  v3 = a1;
  v4 = v1 + 1;
  v5 = 6;
  v6 = (_DWORD *)sub_140001598((_QWORD *)a1, (_BYTE *)(v1 + 1));
  v7 = (char *)(v1 + 2);
  while ( sub_140001608((signed __int64 *)v3, v7) )
  {
    v8 = (_DWORD *)sub_140001608((signed __int64 *)v3, v7);
    ++v4;
    ++v7;
    v2 = (unsigned int)(*v8 + v2);
    ++v5;
  }
  *v6 = 0;
  if ( *(_BYTE *)v1 == 32 )
    v9 = *(_DWORD *)(unsigned int)(v2 + *(_DWORD *)(v4 + 1));
  else
    v9 = *(_DWORD *)(*(_QWORD *)(*(_QWORD *)v3 + 88i64) + *(_DWORD *)(v4 + 1) + v2);
  *v6 = v9;
  return do_vmwrite(__CFADD__(&v11, 32i64), &v12 == 0i64, *(_QWORD *)(v3 + 16) + (unsigned int)v5);
}

//----- (0000000140001EBC) ----------------------------------------------------
char __fastcall sub_140001EBC(__int64 a1)
{
  signed __int64 v1; // rax@1
  __int64 v2; // rbx@1
  char v4; // [sp+0h] [bp-28h]@1
  __int64 v5; // [sp+20h] [bp-8h]@1

  *(_QWORD *)sub_140001608((signed __int64 *)a1, (char *)(*(_QWORD *)(a1 + 16) + 1i64)) = **(_QWORD **)(*(_QWORD *)a1 + 88i64);
  v1 = *(_QWORD *)a1;
  *(_QWORD *)(v1 + 88) += 8i64;
  v2 = *(_QWORD *)(v1 + 88);
  do_vmwrite(__CFADD__(*(_QWORD *)(a1 + 16), 2i64), *(_QWORD *)(a1 + 16) == -2i64, *(_QWORD *)(a1 + 16) + 2i64);
  return do_vmwrite(__CFADD__(&v4, 32i64), &v5 == 0i64, v2);
}

//----- (0000000140001F18) ----------------------------------------------------
char __fastcall sub_140001F18(__int64 a1)
{
  __int64 v1; // rdi@1
  _QWORD *v2; // rax@1
  __int64 v3; // rdx@1
  __int64 v4; // rbx@1
  char v6; // [sp+0h] [bp-28h]@1
  __int64 v7; // [sp+20h] [bp-8h]@1

  v1 = a1;
  v2 = (_QWORD *)sub_140001608((signed __int64 *)a1, (char *)(*(_QWORD *)(a1 + 16) + 1i64));
  v3 = *(_QWORD *)v1;
  *(_QWORD *)(v3 + 88) -= 8i64;
  v4 = *(_QWORD *)(v3 + 88);
  **(_QWORD **)(*(_QWORD *)v1 + 88i64) = *v2;
  do_vmwrite(__CFADD__(*(_QWORD *)(v1 + 16), 2i64), *(_QWORD *)(v1 + 16) == -2i64, *(_QWORD *)(v1 + 16) + 2i64);
  return do_vmwrite(__CFADD__(&v6, 32i64), &v7 == 0i64, v4);
}

//----- (0000000140001F74) ----------------------------------------------------
char __fastcall sub_140001F74(__int64 a1)
{
  __int64 v1; // rbx@1
  char v3; // [sp+0h] [bp-28h]@1
  __int64 v4; // [sp+20h] [bp-8h]@1

  v1 = a1;
  sub_140004C80(
    *(signed __int64 **)(*(_QWORD *)a1 + 64i64),
    **(_BYTE **)(*(_QWORD *)a1 + 120i64),
    *(_QWORD *)(*(_QWORD *)a1 + 112i64));
  return do_vmwrite(__CFADD__(&v3, 32i64), &v4 == 0i64, *(_QWORD *)(v1 + 16) + 1i64);
}

//----- (0000000140001FAC) ----------------------------------------------------
char __fastcall sub_140001FAC(__int64 a1)
{
  __int64 *v1; // rax@1
  __int64 v2; // rdx@1
  __int64 v3; // rbx@1
  char v5; // [sp+0h] [bp-28h]@1
  __int64 v6; // [sp+20h] [bp-8h]@1

  v1 = *(__int64 **)(*(_QWORD *)a1 + 88i64);
  v2 = *v1;
  v3 = (__int64)(v1 + 1);
  *(_QWORD *)(*(_QWORD *)a1 + 88i64) = v1 + 1;
  do_vmwrite(0, 0, v2);
  return do_vmwrite(__CFADD__(&v5, 32i64), &v6 == 0i64, v3);
}

//----- (0000000140001FE0) ----------------------------------------------------
char __fastcall sub_140001FE0(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rdi@1
  unsigned int *v3; // rax@1
  char v5; // [sp+0h] [bp-28h]@1
  __int64 v6; // [sp+20h] [bp-8h]@1

  v1 = *(_QWORD *)(a1 + 16);
  v2 = a1;
  v3 = (unsigned int *)sub_140001608((signed __int64 *)a1, (char *)(v1 + 1));
  *v3 >>= *(_BYTE *)(v1 + 2);
  return do_vmwrite(__CFADD__(&v5, 32i64), &v6 == 0i64, *(_QWORD *)(v2 + 16) + 3i64);
}

//----- (000000014000201C) ----------------------------------------------------
char __fastcall sub_14000201C(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rdi@1
  unsigned int *v3; // rax@1
  char v5; // [sp+0h] [bp-28h]@1
  __int64 v6; // [sp+20h] [bp-8h]@1

  v1 = *(_QWORD *)(a1 + 16);
  v2 = a1;
  v3 = (unsigned int *)sub_140001598((_QWORD *)a1, (_BYTE *)(v1 + 1));
  *v3 >>= *(_BYTE *)(v1 + 2);
  return do_vmwrite(__CFADD__(&v5, 32i64), &v6 == 0i64, *(_QWORD *)(v2 + 16) + 3i64);
}

//----- (0000000140002058) ----------------------------------------------------
char __fastcall sub_140002058(__int64 a1)
{
  *(_BYTE *)(*(_DWORD *)(*(_QWORD *)(a1 + 16) + 1i64) + *(_QWORD *)(*(_QWORD *)a1 + 88i64)) = *(_BYTE *)(*(_QWORD *)a1 + 120i64);
  return do_vmwrite(
           __CFADD__(*(_QWORD *)(a1 + 16), 5i64),
           *(_QWORD *)(a1 + 16) == -5i64,
           *(_QWORD *)(a1 + 16) + 5i64);
}

//----- (0000000140002084) ----------------------------------------------------
char __fastcall sub_140002084(_QWORD *a1)
{
  __int64 v1; // rbx@1
  _QWORD *v2; // rdi@1
  char v4; // [sp+0h] [bp-28h]@1
  __int64 v5; // [sp+20h] [bp-8h]@1

  v1 = a1[2];
  v2 = a1;
  *(_DWORD *)(*(_DWORD *)(v1 + 2) + *(_QWORD *)(*a1 + 88i64)) = *(_DWORD *)sub_140001598(a1, (_BYTE *)(v1 + 1));
  return do_vmwrite(__CFADD__(&v4, 32i64), &v5 == 0i64, v2[2] + 6i64);
}

//----- (00000001400020CC) ----------------------------------------------------
char __fastcall sub_1400020CC(signed __int64 *a1)
{
  signed __int64 v1; // rbx@1
  signed __int64 *v2; // rdi@1
  char v4; // [sp+0h] [bp-28h]@1
  __int64 v5; // [sp+20h] [bp-8h]@1

  v1 = a1[2];
  v2 = a1;
  *(_QWORD *)(*(_DWORD *)(v1 + 2) + *(_QWORD *)(*a1 + 88)) = *(_QWORD *)sub_140001608(a1, (char *)(v1 + 1));
  return do_vmwrite(__CFADD__(&v4, 32i64), &v5 == 0i64, v2[2] + 6);
}

//----- (0000000140002114) ----------------------------------------------------
char __fastcall sub_140002114(__int64 a1)
{
  __int64 v1; // rdi@1
  __int64 v2; // rsi@1
  _QWORD *v3; // rbx@1
  char v5; // [sp+0h] [bp-28h]@1
  __int64 v6; // [sp+20h] [bp-8h]@1

  v1 = *(_QWORD *)(a1 + 16);
  v2 = a1;
  v3 = (_QWORD *)sub_140001608((signed __int64 *)a1, (char *)(v1 + 1));
  **(_QWORD **)sub_140001608((signed __int64 *)v2, (char *)(v1 + 2)) = *v3;
  return do_vmwrite(__CFADD__(&v5, 32i64), &v6 == 0i64, *(_QWORD *)(v2 + 16) + 3i64);
}

//----- (000000014000216C) ----------------------------------------------------
char __fastcall sub_14000216C(__int64 a1)
{
  *(_QWORD *)(*(_DWORD *)(*(_QWORD *)(a1 + 16) + 1i64) + *(_QWORD *)(*(_QWORD *)a1 + 88i64)) = *(_QWORD *)(*(_QWORD *)(a1 + 16) + 5i64);
  return do_vmwrite(
           __CFADD__(*(_QWORD *)(a1 + 16), 13i64),
           *(_QWORD *)(a1 + 16) == -13i64,
           *(_QWORD *)(a1 + 16) + 13i64);
}

//----- (0000000140002198) ----------------------------------------------------
char __fastcall sub_140002198(__int64 a1)
{
  __int64 v1; // rdi@1
  __int64 v2; // rsi@1
  _QWORD *v3; // rbx@1
  bool v4; // zf@2
  char v6; // [sp+0h] [bp-28h]@4
  __int64 v7; // [sp+20h] [bp-8h]@4

  v1 = *(_QWORD *)(a1 + 16);
  v2 = a1;
  v3 = (_QWORD *)sub_140001598((_QWORD *)a1, (_BYTE *)(v1 + 2));
  if ( *(_QWORD *)sub_140001598((_QWORD *)v2, (_BYTE *)(v1 + 1)) & *v3 )
  {
    v4 = (*(_QWORD *)(v2 + 8) & 0xFFFFFFFFFFFFFFBFui64) == 0;
    *(_QWORD *)(v2 + 8) &= 0xFFFFFFFFFFFFFFBFui64;
  }
  else
  {
    v4 = (*(_QWORD *)(v2 + 8) | 0x40i64) == 0;
    *(_QWORD *)(v2 + 8) |= 0x40ui64;
  }
  do_vmwrite(0, v4, *(_QWORD *)(v2 + 8));
  return do_vmwrite(__CFADD__(&v6, 32i64), &v7 == 0i64, *(_QWORD *)(v2 + 16) + 3i64);
}

//----- (000000014000220C) ----------------------------------------------------
char __fastcall sub_14000220C(__int64 a1)
{
  __int64 v1; // rdi@1
  __int64 v2; // rsi@1
  _DWORD *v3; // rbx@1
  bool v4; // zf@2
  char v6; // [sp+0h] [bp-28h]@4
  __int64 v7; // [sp+20h] [bp-8h]@4

  v1 = *(_QWORD *)(a1 + 16);
  v2 = a1;
  v3 = (_DWORD *)sub_140001608((signed __int64 *)a1, (char *)(v1 + 2));
  if ( *(_DWORD *)sub_140001608((signed __int64 *)v2, (char *)(v1 + 1)) & *v3 )
  {
    v4 = (*(_QWORD *)(v2 + 8) & 0xFFFFFFFFFFFFFFBFui64) == 0;
    *(_QWORD *)(v2 + 8) &= 0xFFFFFFFFFFFFFFBFui64;
  }
  else
  {
    v4 = (*(_QWORD *)(v2 + 8) | 0x40i64) == 0;
    *(_QWORD *)(v2 + 8) |= 0x40ui64;
  }
  do_vmwrite(0, v4, *(_QWORD *)(v2 + 8));
  return do_vmwrite(__CFADD__(&v6, 32i64), &v7 == 0i64, *(_QWORD *)(v2 + 16) + 3i64);
}

//----- (000000014000227C) ----------------------------------------------------
char __fastcall sub_14000227C(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rdi@1
  _DWORD *v3; // rax@1
  char v5; // [sp+0h] [bp-28h]@1
  __int64 v6; // [sp+20h] [bp-8h]@1

  v1 = *(_QWORD *)(a1 + 16);
  v2 = a1;
  v3 = (_DWORD *)sub_140001598((_QWORD *)a1, (_BYTE *)(v1 + 1));
  *v3 ^= *(_DWORD *)(*(_DWORD *)(v1 + 2) + *(_QWORD *)(*(_QWORD *)v2 + 88i64));
  return do_vmwrite(__CFADD__(&v5, 32i64), &v6 == 0i64, *(_QWORD *)(v2 + 16) + 6i64);
}

//----- (00000001400022C4) ----------------------------------------------------
char __fastcall sub_1400022C4(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rdi@1
  _DWORD *v3; // rax@1
  char v5; // [sp+0h] [bp-28h]@1
  __int64 v6; // [sp+20h] [bp-8h]@1

  v1 = *(_QWORD *)(a1 + 16);
  v2 = a1;
  v3 = (_DWORD *)sub_140001598((_QWORD *)a1, (_BYTE *)(v1 + 1));
  *v3 ^= *(_DWORD *)(v1 + 2);
  return do_vmwrite(__CFADD__(&v5, 32i64), &v6 == 0i64, *(_QWORD *)(v2 + 16) + 6i64);
}

//----- (0000000140002300) ----------------------------------------------------
char __fastcall sub_140002300(__int64 a1)
{
  __int64 v1; // rdi@1
  __int64 v2; // rsi@1
  _DWORD *v3; // rbx@1
  char v5; // [sp+0h] [bp-28h]@1
  __int64 v6; // [sp+20h] [bp-8h]@1

  v1 = *(_QWORD *)(a1 + 16);
  v2 = a1;
  v3 = (_DWORD *)sub_140001598((_QWORD *)a1, (_BYTE *)(v1 + 1));
  *v3 ^= *(_DWORD *)sub_140001598((_QWORD *)v2, (_BYTE *)(v1 + 2));
  return do_vmwrite(__CFADD__(&v5, 32i64), &v6 == 0i64, *(_QWORD *)(v2 + 16) + 3i64);
}

//----- (0000000140002354) ----------------------------------------------------
char __fastcall sub_140002354(__int64 a1)
{
  __int64 v1; // rdi@1
  __int64 v2; // rsi@1
  _QWORD *v3; // rbx@1
  char v5; // [sp+0h] [bp-28h]@1
  __int64 v6; // [sp+20h] [bp-8h]@1

  v1 = *(_QWORD *)(a1 + 16);
  v2 = a1;
  v3 = (_QWORD *)sub_140001608((signed __int64 *)a1, (char *)(v1 + 2));
  *v3 ^= *(_QWORD *)sub_140001608((signed __int64 *)v2, (char *)(v1 + 1));
  return do_vmwrite(__CFADD__(&v5, 32i64), &v6 == 0i64, *(_QWORD *)(v2 + 16) + 3i64);
}

//----- (00000001400023AC) ----------------------------------------------------
__int64 __fastcall sub_1400023AC(__int64 a1)
{
  signed __int64 *v1; // rbx@1
  unsigned __int64 v2; // rdi@1
  char *v3; // rcx@1
  char v4; // al@1
  char v5; // dl@12
  char v6; // dl@17
  char v7; // dl@22
  char v8; // cl@54

  v1 = (signed __int64 *)a1;
  v2 = __readcr3();
  __writecr3(do_vmread(0x6802u));
  v3 = *(char **)(a1 + 16);
  v4 = *v3;
  if ( *v3 == 1 )
  {
    sub_140001FAC((__int64)v1);
    goto LABEL_91;
  }
  if ( v4 == -69 )
  {
    sub_140001EBC((__int64)v1);
    goto LABEL_91;
  }
  if ( v4 == -86 )
  {
    sub_140001F18((__int64)v1);
    goto LABEL_91;
  }
  if ( v4 == -62 )
  {
    sub_1400016EC((__int64)v1);
    goto LABEL_91;
  }
  if ( !v4 )
  {
    sub_140001BE4((__int64)v1);
    goto LABEL_91;
  }
  if ( v4 == -61 )
  {
    v5 = 0;
LABEL_15:
    sub_140001A08((__int64)v1, v5);
    goto LABEL_91;
  }
  if ( v4 == -63 )
  {
    v5 = 1;
    goto LABEL_15;
  }
  if ( v4 == -47 )
  {
    v6 = 1;
LABEL_20:
    sub_14000198C((__int64)v1, v6);
    goto LABEL_91;
  }
  if ( v4 == -45 )
  {
    v6 = 0;
    goto LABEL_20;
  }
  if ( v4 == -46 )
  {
    v7 = 1;
LABEL_25:
    sub_140001A8C((__int64)v1, v7);
    goto LABEL_91;
  }
  if ( v4 == -44 )
  {
    v7 = 0;
    goto LABEL_25;
  }
  switch ( v4 )
  {
    case -55:
      sub_14000216C((__int64)v1);
      break;
    case -43:
      sub_140002300((__int64)v1);
      break;
    case -59:
      sub_140002354((__int64)v1);
      break;
    case -42:
      sub_140001C3C((__int64)v1);
      break;
    case -58:
      sub_140001C78((__int64)v1);
      break;
    case 48:
      sub_140001F74((__int64)v1);
      break;
    case -56:
      sub_1400020CC(v1);
      break;
    case -40:
      sub_140002084(v1);
      break;
    case 26:
      sub_140001B48((__int64)v1);
      break;
    case -57:
      sub_140002114((__int64)v1);
      break;
    case 74:
      sub_140001900((__int64)v1);
      break;
    case 68:
      sub_140002198((__int64)v1);
      break;
    case 64:
      sub_140001818((__int64)v1);
      break;
    case 66:
      sub_140001780((__int64)v1);
      break;
    default:
      v8 = *v3;
      switch ( v8 )
      {
        case 80:
          sub_1400016D4((__int64)v1);
          break;
        case 81:
          sub_1400018B0((__int64)v1);
          break;
        case 82:
          sub_1400018D8((__int64)v1);
          break;
        case 84:
          sub_140001880((__int64)v1);
          break;
        default:
          if ( (v8 - 28) & 0xFB )
          {
            if ( (unsigned __int8)(v8 - 30) > 1u )
            {
              switch ( v8 )
              {
                case 29:
                  sub_140001D74((__int64)v1);
                  break;
                case -41:
                  sub_14000227C((__int64)v1);
                  break;
                case 25:
                  sub_140001944((__int64)v1);
                  break;
                case 27:
                  sub_140001B20((__int64)v1);
                  break;
                case 23:
                  sub_140002058((__int64)v1);
                  break;
                case -64:
                  sub_1400022C4((__int64)v1);
                  break;
                case 2:
                  sub_140001B90((__int64)v1);
                  break;
                case 67:
                  sub_14000220C((__int64)v1);
                  break;
                case -66:
                  sub_140001744((__int64)v1);
                  break;
                case -68:
                  sub_14000201C((__int64)v1);
                  break;
                case -71:
                  sub_140001FE0((__int64)v1);
                  break;
                case 65:
                  sub_1400017C8((__int64)v1);
                  break;
                default:
                  __debugbreak();
                  break;
              }
            }
            else
            {
              sub_140001CB8((__int64)v1);
            }
          }
          else
          {
            sub_140001E04((__int64)v1);
          }
          break;
      }
      break;
  }
LABEL_91:
  __writecr3(v2);
  return 0i64;
}

//----- (00000001400026A8) ----------------------------------------------------
__int64 __fastcall sub_1400026A8(__int64 a1)
{
  return **(_QWORD **)a1;
}

//----- (00000001400026B0) ----------------------------------------------------
signed __int64 __fastcall sub_1400026B0(__int64 a1, unsigned __int64 a2)
{
  return sub_140002AE0(*(_QWORD *)(a1 + 8), 4, a2);
}

//----- (00000001400026C4) ----------------------------------------------------
signed __int64 __fastcall sub_1400026C4(__int64 a1)
{
  __int64 v1; // rsi@1
  signed int v2; // edi@1
  char v3; // bl@1
  __int64 v4; // rbp@1
  _QWORD *v5; // rax@4
  _QWORD *v7; // rax@9
  _QWORD *v8; // rax@12

  v1 = a1;
  v2 = 0;
  v3 = do_vmread(0x6400u);
  v4 = do_vmread(0x2400u);
  if ( (v3 & 0x24) == 4 )
  {
    v2 = 1;
LABEL_18:
    sub_140002D30();
    return (unsigned int)v2;
  }
  if ( (v3 & 0x12) == 2 )
  {
    v5 = (_QWORD *)sub_140002AE0(*(_QWORD *)(v1 + 8), 4, v4);
    if ( v5 && *v5 )
      return 2i64;
    goto LABEL_17;
  }
  if ( v3 & 1 && !(v3 & 8) )
  {
    v7 = (_QWORD *)sub_140002AE0(*(_QWORD *)(v1 + 8), 4, v4);
    if ( v7 && *v7 )
      return 3i64;
    goto LABEL_17;
  }
  v8 = (_QWORD *)sub_140002AE0(*(_QWORD *)(v1 + 8), 4, v4);
  if ( !v8 || !*v8 )
  {
LABEL_17:
    sub_140002870(*(_QWORD *)(v1 + 8), 4, v4, v1);
    goto LABEL_18;
  }
  if ( !(_BYTE)KdDebuggerNotPresent )
    __debugbreak();
  return 0i64;
}

//----- (00000001400027C4) ----------------------------------------------------
void __fastcall sub_1400027C4(__int64 a1)
{
  __int64 v1; // rbx@1

  v1 = a1;
  sub_140002A84(*(void **)(a1 + 16), *(_DWORD *)(a1 + 24));
  sub_1400029E4(*(void **)(v1 + 8), 4);
  ExFreePoolWithTag(*(PVOID *)v1, 0x56484C46u);
  ExFreePoolWithTag((PVOID)v1, 0x56484C46u);
}

//----- (000000014000280C) ----------------------------------------------------
signed __int64 *__fastcall sub_14000280C(__int64 a1)
{
  signed __int64 *v1; // rbx@1
  signed __int64 *result; // rax@2
  signed __int64 *v3; // rax@3
  signed __int64 *v4; // rdi@3

  v1 = 0i64;
  if ( a1 )
  {
    result = *(signed __int64 **)(*(_QWORD *)(a1 + 16)
                                + 8i64 * _InterlockedExchangeAdd((volatile signed __int32 *)(a1 + 24), 1u));
  }
  else
  {
    v3 = (signed __int64 *)ExAllocatePoolWithTag(0, 0x1000ui64, 0x56484C46u);
    v4 = v3;
    if ( v3 )
    {
      sub_140004C80(v3, 0i64, 0x1000ui64);
      v1 = v4;
    }
    result = v1;
  }
  return result;
}

//----- (0000000140002870) ----------------------------------------------------
__int64 *__fastcall sub_140002870(__int64 a1, signed int a2, unsigned __int64 a3, __int64 a4)
{
  __int64 v4; // rbp@1
  unsigned __int64 v5; // rdi@1
  signed int v6; // ebx@1
  int v7; // ebx@2
  int v8; // ebx@3
  int v9; // ebx@4
  __int64 *v10; // rsi@6
  signed __int64 *v11; // rax@7
  unsigned __int64 v12; // rax@8
  __int64 v13; // rax@10
  signed __int64 *v14; // rax@12
  unsigned __int64 v15; // rax@13
  signed __int64 *v16; // rax@16
  unsigned __int64 v17; // rax@17
  __int64 *v19; // rbx@22

  v4 = a4;
  v5 = a3;
  v6 = a2;
  while ( 1 )
  {
    v7 = v6 - 1;
    if ( !v7 )
      break;
    v8 = v7 - 1;
    if ( v8 )
    {
      v9 = v8 - 1;
      if ( v9 )
      {
        if ( v9 != 1 )
        {
          if ( !(_BYTE)KdDebuggerNotPresent )
            __debugbreak();
          return 0i64;
        }
        v10 = (__int64 *)(a1 + 8 * ((v5 >> 39) & 0x1FF));
        if ( !*v10 )
        {
          v11 = sub_14000280C(v4);
          if ( !v11 )
            return 0i64;
          LODWORD(v12) = MmGetPhysicalAddress(v11);
          sub_140002C58(v10, 4, v12);
        }
        v6 = 3;
      }
      else
      {
        v10 = (__int64 *)(a1 + 8 * ((v5 >> 30) & 0x1FF));
        if ( !*v10 )
        {
          v14 = sub_14000280C(v4);
          if ( !v14 )
            return 0i64;
          LODWORD(v15) = MmGetPhysicalAddress(v14);
          sub_140002C58(v10, 3, v15);
        }
        v6 = 2;
      }
    }
    else
    {
      v10 = (__int64 *)(a1 + 8 * ((v5 >> 21) & 0x1FF));
      if ( !*v10 )
      {
        v16 = sub_14000280C(v4);
        if ( !v16 )
          return 0i64;
        LODWORD(v17) = MmGetPhysicalAddress(v16);
        sub_140002C58(v10, 2, v17);
      }
      v6 = 1;
    }
    LODWORD(v13) = sub_140002F8C(((unsigned __int64)*v10 >> 12) & 0xFFFFFFFFFi64);
    a1 = v13;
  }
  v19 = (__int64 *)(a1 + 8 * ((v5 >> 12) & 0x1FF));
  sub_140002C58(v19, 1, v5);
  return v19;
}
// 140002F70: using guessed type int __fastcall MmGetPhysicalAddress(_QWORD);

//----- (00000001400029E4) ----------------------------------------------------
void __fastcall sub_1400029E4(void *a1, int a2)
{
  int v2; // edi@1
  void *v3; // rbp@1
  unsigned __int64 *v4; // rbx@1
  signed __int64 v5; // rsi@1
  void *v6; // rax@3

  v2 = a2;
  v3 = a1;
  v4 = (unsigned __int64 *)a1;
  v5 = 512i64;
  do
  {
    if ( (*v4 >> 12) & 0xFFFFFFFFFi64 )
    {
      LODWORD(v6) = sub_140002F8C((*v4 >> 12) & 0xFFFFFFFFFi64);
      if ( v2 == 2 )
      {
        ExFreePoolWithTag(v6, 0x56484C46u);
      }
      else if ( (unsigned int)(v2 - 3) > 1 )
      {
        if ( !(_BYTE)KdDebuggerNotPresent )
          __debugbreak();
      }
      else
      {
        sub_1400029E4(v6, (unsigned int)(v2 - 1));
      }
    }
    ++v4;
    --v5;
  }
  while ( v5 );
  ExFreePoolWithTag(v3, 0x56484C46u);
}

//----- (0000000140002A84) ----------------------------------------------------
void __fastcall sub_140002A84(void *a1, signed int a2)
{
  signed int v2; // ebx@1
  void *v3; // rsi@1
  PVOID *v4; // rdi@2

  v2 = a2;
  v3 = a1;
  if ( a2 < 50 )
  {
    v4 = (PVOID *)((char *)a1 + 8 * a2);
    do
    {
      if ( !*v4 )
        break;
      ExFreePoolWithTag(*v4, 0x56484C46u);
      ++v2;
      ++v4;
    }
    while ( v2 < 50 );
  }
  ExFreePoolWithTag(v3, 0x56484C46u);
}

//----- (0000000140002AE0) ----------------------------------------------------
signed __int64 __fastcall sub_140002AE0(__int64 a1, signed int a2, unsigned __int64 a3)
{
  unsigned __int64 v3; // rdi@1
  signed int v4; // ebx@1
  int v5; // ebx@2
  int v6; // ebx@3
  int v7; // ebx@4
  unsigned __int64 v8; // rcx@6
  __int64 v9; // rax@12

  v3 = a3;
  v4 = a2;
  if ( !a1 )
    return 0i64;
  while ( 1 )
  {
    v5 = v4 - 1;
    if ( !v5 )
      return a1 + 8 * ((v3 >> 12) & 0x1FF);
    v6 = v5 - 1;
    if ( !v6 )
    {
      v8 = *(_QWORD *)(a1 + 8 * ((v3 >> 21) & 0x1FF));
      if ( !v8 )
        return 0i64;
      v4 = 1;
      goto LABEL_12;
    }
    v7 = v6 - 1;
    if ( !v7 )
    {
      v8 = *(_QWORD *)(a1 + 8 * ((v3 >> 30) & 0x1FF));
      if ( !v8 )
        return 0i64;
      v4 = 2;
      goto LABEL_12;
    }
    if ( v7 != 1 )
      break;
    v8 = *(_QWORD *)(a1 + 8 * ((v3 >> 39) & 0x1FF));
    if ( !v8 )
      return 0i64;
    v4 = 3;
LABEL_12:
    LODWORD(v9) = sub_140002F8C((v8 >> 12) & 0xFFFFFFFFFi64);
    a1 = v9;
    if ( !v9 )
      return 0i64;
  }
  if ( !(_BYTE)KdDebuggerNotPresent )
    __debugbreak();
  return 0i64;
}

//----- (0000000140002BBC) ----------------------------------------------------
__int64 __fastcall sub_140002BBC(unsigned __int64 a1)
{
  __m128i *v1; // r8@1
  unsigned __int64 v2; // rdx@1
  bool v3; // zf@9
  __int64 result; // rax@15
  __m128i v5; // [sp+0h] [bp-28h]@2

  v1 = (__m128i *)&unk_140007330;
  LOBYTE(v2) = -1;
  do
  {
    v5 = *v1;
    if ( !(unsigned __int8)_mm_cvtsi128_si32(*v1) )
      break;
    if ( v5.m128i_i64[1] <= a1 && a1 <= v1[1].m128i_i64[0] )
    {
      if ( v5.m128i_i8[1] )
      {
        LOBYTE(v2) = (unsigned __int64)v5.m128i_i64[0] >> 16;
        break;
      }
      if ( !(unsigned __int8)((unsigned __int64)v5.m128i_i64[0] >> 16) )
      {
        v2 = (unsigned __int64)v5.m128i_i64[0] >> 16;
        break;
      }
      if ( (_BYTE)v2 != 4 && (unsigned __int8)((unsigned __int64)v5.m128i_i64[0] >> 16) != 4
        || (v3 = (_BYTE)v2 == 6, LOBYTE(v2) = 4, !v3) )
      {
        LOBYTE(v2) = (unsigned __int64)*(_OWORD *)v1 >> 16;
      }
    }
    v1 = (__m128i *)((char *)v1 + 24);
  }
  while ( (char *)v1 != &byte_140008C20 );
  result = (unsigned __int8)v2;
  if ( (_BYTE)v2 == -1 )
    result = (unsigned __int8)byte_140008C20;
  return result;
}
// 140008C20: using guessed type char byte_140008C20;

//----- (0000000140002C58) ----------------------------------------------------
unsigned __int64 __fastcall sub_140002C58(__int64 *a1, int a2, unsigned __int64 a3)
{
  signed __int64 v3; // rax@1
  __int64 *v4; // rbx@1
  unsigned __int64 v5; // rdi@1
  int v6; // esi@1
  signed __int64 v7; // rcx@1
  unsigned __int64 result; // rax@3
  __int64 v9; // r11@3
  __int64 v10; // r11@4

  v3 = 1i64;
  v4 = a1;
  v5 = a3;
  v6 = a2;
  v7 = 2i64;
  do
  {
    *v4 |= v3++;
    --v7;
  }
  while ( v7 );
  *v4 |= 4ui64;
  result = (*v4 ^ (sub_140002F78(a3) << 12)) & 0xFFFFFFFFF000i64;
  *v4 ^= result;
  v9 = *v4;
  if ( v6 == 1 )
  {
    result = sub_140002BBC(v5);
    *v4 = v10 ^ ((unsigned __int8)v10 ^ (unsigned __int8)(8 * result)) & 0x38;
  }
  return result;
}

//----- (0000000140002CDC) ----------------------------------------------------
int __fastcall sub_140002CDC(__int64 a1)
{
  int result; // eax@2

  if ( qword_140008C48 )
    result = qword_140008C48(a1, 0i64, -1i64, 0i64);
  else
    result = MmAllocateContiguousMemory(a1, -1i64);
  return result;
}
// 1400060A8: using guessed type int __fastcall MmAllocateContiguousMemory(_QWORD, _QWORD);
// 140008C48: using guessed type int (__fastcall *qword_140008C48)(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000140002D28) ----------------------------------------------------
PVOID sub_140002D28()
{
  return P;
}

//----- (0000000140002D30) ----------------------------------------------------
void sub_140002D30()
{
  __int64 v0; // [sp+0h] [bp-48h]@1
  __int64 v1; // [sp+20h] [bp-28h]@1
  __int64 v2; // [sp+28h] [bp-20h]@1
  __int64 v3; // [sp+30h] [bp-18h]@1

  v1 = 0i64;
  v2 = 0i64;
  sub_14000153A(0, 1, (__int64)&v1, 2);
  sub_140004B50((unsigned __int64)&v0 ^ v3);
}

//----- (0000000140002D70) ----------------------------------------------------
void sub_140002D70()
{
  __int64 v0; // [sp+0h] [bp-48h]@1
  __int64 v1; // [sp+20h] [bp-28h]@1
  __int64 v2; // [sp+28h] [bp-20h]@1
  __int64 v3; // [sp+30h] [bp-18h]@1

  v1 = 0i64;
  v2 = 0i64;
  sub_140001557(0, 1, (__int64)&v1, 2);
  sub_140004B50((unsigned __int64)&v0 ^ v3);
}

//----- (0000000140002DB0) ----------------------------------------------------
void __fastcall sub_140002DB0(__int16 a1, __int64 a2)
{
  __int64 v2; // [sp+0h] [bp-48h]@1
  __int64 v3; // [sp+20h] [bp-28h]@1
  __int64 v4; // [sp+28h] [bp-20h]@1
  __int64 v5; // [sp+30h] [bp-18h]@1

  v4 = a2;
  v3 = 0i64;
  LOWORD(v3) = a1;
  sub_140001557(0, 1, (__int64)&v3, 0);
  sub_140004B50((unsigned __int64)&v2 ^ v5);
}

//----- (0000000140002DF4) ----------------------------------------------------
void __fastcall sub_140002DF4(__int16 a1)
{
  __int64 v1; // [sp+0h] [bp-48h]@1
  __int64 v2; // [sp+20h] [bp-28h]@1
  __int64 v3; // [sp+28h] [bp-20h]@1
  __int64 v4; // [sp+30h] [bp-18h]@1

  v2 = 0i64;
  LOWORD(v2) = a1;
  v3 = 0i64;
  sub_140001557(0, 1, (__int64)&v2, 3);
  sub_140004B50((unsigned __int64)&v1 ^ v4);
}

//----- (0000000140002E38) ----------------------------------------------------
char sub_140002E38()
{
  return 0;
}

//----- (0000000140002E3C) ----------------------------------------------------
void __fastcall sub_140002E3C(unsigned __int64 a1)
{
  unsigned __int64 v1; // rsi@1
  unsigned int v2; // edi@1
  __int64 *v3; // rbx@1
  __int64 v4; // rax@2
  __int64 v9; // [sp+0h] [bp-58h]@3
  __int64 v10; // [sp+20h] [bp-38h]@1
  __int64 v14; // [sp+40h] [bp-18h]@3

  v1 = __readcr3();
  __writecr3(a1);
  sub_140004C80(&v10, 0i64, 0x20ui64);
  v2 = 0;
  v3 = &v10;
  do
  {
    LODWORD(v4) = MmGetPhysicalAddress(qword_140008C60 + (v2++ << 12));
    *v3 = *v3 ^ (*v3 ^ v4) & 0x1FFFFFFFFFF000i64 | 1;
    ++v3;
  }
  while ( v2 < 4 );
  __writecr3(v1);
  __asm
  {
    vmwrite rcx, [rsp+58h+var_38]
    vmwrite rcx, [rsp+58h+var_30]
    vmwrite rcx, [rsp+58h+var_28]
    vmwrite rcx, [rsp+58h+var_20]
  }
  sub_140004B50((unsigned __int64)&v9 ^ v14);
}
// 1400060D0: using guessed type int __fastcall MmGetPhysicalAddress(_QWORD);
// 140008C60: using guessed type __int64 qword_140008C60;

//----- (0000000140002EF8) ----------------------------------------------------
void *__fastcall sub_140002EF8(void *Source2, SIZE_T a2, const void *a3, SIZE_T a4)
{
  SIZE_T v4; // rsi@1
  const void *v5; // r14@1
  _BYTE *v6; // rbp@1
  void *result; // rax@2
  unsigned __int64 v8; // rdi@3
  void *v9; // rbx@3

  v4 = a4;
  v5 = a3;
  v6 = Source2;
  if ( a4 <= a2 )
  {
    v8 = a2 - a4;
    v9 = Source2;
    while ( RtlCompareMemory(v5, v9, v4) != v4 )
    {
      v9 = (char *)v9 + 1;
      if ( (_BYTE *)v9 - v6 > v8 )
        goto LABEL_2;
    }
    result = v9;
  }
  else
  {
LABEL_2:
    result = 0i64;
  }
  return result;
}

//----- (0000000140002F78) ----------------------------------------------------
unsigned __int64 __fastcall sub_140002F78(unsigned __int64 a1)
{
  return a1 >> 12;
}

//----- (0000000140002F80) ----------------------------------------------------
unsigned __int64 __fastcall sub_140002F80(unsigned int a1)
{
  return __readmsr(a1);
}

//----- (0000000140002F8C) ----------------------------------------------------
int __fastcall sub_140002F8C(__int64 a1)
{
  return MmGetVirtualForPhysical(a1 << 12);
}
// 1400060D8: using guessed type int __fastcall MmGetVirtualForPhysical(_QWORD);

//----- (0000000140002F98) ----------------------------------------------------
__int64 sub_140002F98()
{
  return (unsigned __int8)sub_1400014C9(0, 0) != 0 ? 0xC0000001 : 0;
}

//----- (0000000140002FC0) ----------------------------------------------------
__int64 __fastcall do_vmread(unsigned int a1)
{
  __int64 result; // rax@1

  _RAX = a1;
  __asm { vmread  rax, rax }
  return result;
}

//----- (0000000140002FCC) ----------------------------------------------------
char __usercall do_vmwrite@<al>(char a1@<cf>, char a2@<zf>, __int64 _RDX@<rdx>)
{
  __asm { vmwrite rcx, rdx }
  return a1 + a1 + a2;
}

//----- (0000000140002FD8) ----------------------------------------------------
unsigned __int64 __fastcall sub_140002FD8(unsigned int a1, unsigned __int64 a2)
{
  unsigned __int64 result; // rax@1

  result = a2;
  __writemsr(a1, a2);
  return result;
}

//----- (000000014000302C) ----------------------------------------------------
char __fastcall sub_14000302C(__int64 a1)
{
  __int64 v2; // [sp+20h] [bp-38h]@1
  __int64 v3; // [sp+28h] [bp-30h]@1
  __int64 v4; // [sp+30h] [bp-28h]@1
  unsigned __int64 v5; // [sp+38h] [bp-20h]@1
  char v6; // [sp+40h] [bp-18h]@1
  char v7; // [sp+41h] [bp-17h]@1

  v2 = a1;
  v3 = do_vmread(0x6820u);
  v4 = do_vmread(0x681Eu);
  v5 = __readcr8();
  v6 = __readcr8();
  v7 = 1;
  *(_QWORD *)(v2 + 88) = do_vmread(0x681Cu);
  ((void (__fastcall *)(__int64 *))loc_140004528)(&v2);
  if ( !v7 )
  {
    sub_140002D30();
    sub_140002D70();
  }
  __writecr8(v5);
  return v7;
}

//----- (00000001400030B8) ----------------------------------------------------
__int64 __fastcall sub_1400030B8(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 result; // rax@1

  v1 = a1;
  result = do_vmread(0x681Eu);
  if ( *(_BYTE *)(v1 + 128) & 0x40 )
    result = do_vmread(0x4400u);
  return result;
}

//----- (00000001400030E4) ----------------------------------------------------
char __fastcall sub_1400030E4(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rdi@1
  char result; // al@1
  __int64 v4; // rcx@1
  char v5; // cf@2
  char v6; // zf@2

  v1 = a1;
  v2 = do_vmread(0x440Cu);
  result = do_vmwrite(__CFADD__(v2, *(_QWORD *)(v1 + 16)), v2 + *(_QWORD *)(v1 + 16) == 0, v2 + *(_QWORD *)(v1 + 16));
  v4 = *(_DWORD *)(v1 + 8);
  if ( _bittest64(&v4, 8u) )
  {
    sub_14000481C(3, 1u, 0, 0);
    result = do_vmwrite(v5, v6, v2);
  }
  return result;
}

//----- (0000000140003144) ----------------------------------------------------
char __fastcall sub_140003144(__int64 a1)
{
  __int64 v1; // rsi@1
  unsigned __int64 v2; // rax@1
  unsigned __int64 *v3; // rdi@1
  unsigned __int64 v4; // r9@1
  unsigned __int64 v5; // r9@5
  __int64 v6; // rax@7
  unsigned int v7; // er9@10
  signed __int64 v8; // r9@11
  signed __int64 v9; // r9@12
  __int64 v10; // rax@16
  unsigned __int64 v11; // rbx@17
  __int64 v12; // rdi@17
  char v13; // cf@17
  bool v14; // zf@17
  __int16 v15; // ax@20
  __int64 v16; // rdx@20
  __int64 v17; // rax@22
  unsigned __int64 v18; // rbx@23

  v1 = a1;
  v2 = do_vmread(0x6400u);
  v3 = (unsigned __int64 *)sub_140004878((v2 >> 8) & 0xF, v1);
  if ( !((v4 >> 4) & 3) )
  {
    v7 = v4 & 0xF;
    if ( v7 )
    {
      v8 = v7 - 3i64;
      if ( !v8 )
      {
        if ( sub_140002E38() )
          sub_140002E3C(*v3);
        v15 = KeGetCurrentProcessorNumberEx(0i64);
        sub_140002DF4(v15 + 1);
        v16 = *v3 & 0x7FFFFFFFFFFFFFFFi64;
        v13 = 0;
        v14 = v16 == 0;
        goto LABEL_25;
      }
      v9 = v8 - 1;
      if ( v9 )
      {
        if ( v9 == 4 )
          *(_QWORD *)(v1 + 24) = *v3;
        return sub_1400030E4(v1);
      }
      if ( sub_140002E38() )
      {
        v10 = do_vmread(0x6802u);
        sub_140002E3C(v10);
      }
      sub_140002D70();
      v11 = sub_140002F80(0x488u);
      v12 = v11 | sub_140002F80(0x489u) & *v3;
      do_vmwrite(0, v12 == 0, v12);
    }
    else
    {
      if ( sub_140002E38() )
      {
        v17 = do_vmread(0x6802u);
        sub_140002E3C(v17);
      }
      v18 = sub_140002F80(0x486u);
      v12 = v18 | sub_140002F80(0x487u) & *v3;
      do_vmwrite(0, v12 == 0, v12);
    }
    v16 = v12;
LABEL_25:
    do_vmwrite(v13, v14, v16);
    return sub_1400030E4(v1);
  }
  if ( ((v4 >> 4) & 3) == 1 )
  {
    v5 = v4 & 0xF;
    if ( v5 == 3 )
    {
      v6 = do_vmread(0x6802u);
    }
    else
    {
      if ( v5 != 8 )
        return sub_1400030E4(v1);
      v6 = *(_QWORD *)(v1 + 24);
    }
    *v3 = v6;
    return sub_1400030E4(v1);
  }
  if ( !(_BYTE)KdDebuggerNotPresent )
    __debugbreak();
  return sub_1400030E4(v1);
}
// 140006028: using guessed type int __fastcall KeGetCurrentProcessorNumberEx(_QWORD);

//----- (00000001400032F4) ----------------------------------------------------
char __fastcall sub_1400032F4(__int64 a1)
{
  __int64 v1; // rdi@1
  unsigned __int64 v2; // rax@1
  _QWORD *v3; // rbx@1
  unsigned __int64 v4; // r9@1
  unsigned int v5; // er9@3
  signed __int64 v6; // r9@4
  signed __int64 v7; // r9@5
  signed __int64 v8; // r9@6
  signed __int64 v9; // r9@7
  signed __int64 v10; // r9@8
  signed __int64 v11; // r9@9
  __int64 v12; // rax@11

  v1 = a1;
  v2 = do_vmread(0x6400u);
  v3 = (_QWORD *)sub_140004878((v2 >> 8) & 0xF, v1);
  if ( (v4 >> 4) & 1 && ((v4 >> 4) & 1) == 1 )
  {
    v5 = v4 & 7;
    if ( !v5 )
    {
      v12 = __readdr(0);
      goto LABEL_19;
    }
    v6 = v5 - 1i64;
    if ( !v6 )
    {
      v12 = __readdr(1u);
      goto LABEL_19;
    }
    v7 = v6 - 1;
    if ( !v7 )
    {
      v12 = __readdr(2u);
      goto LABEL_19;
    }
    v8 = v7 - 1;
    if ( !v8 )
    {
      v12 = __readdr(3u);
      goto LABEL_19;
    }
    v9 = v8 - 1;
    if ( !v9 )
    {
      v12 = __readdr(4u);
      goto LABEL_19;
    }
    v10 = v9 - 1;
    if ( !v10 )
    {
      v12 = __readdr(5u);
      goto LABEL_19;
    }
    v11 = v10 - 1;
    if ( !v11 )
    {
      v12 = __readdr(6u);
      goto LABEL_19;
    }
    if ( v11 == 1 )
    {
      v12 = do_vmread(0x681Au);
LABEL_19:
      *v3 = v12;
      return sub_1400030E4(v1);
    }
  }
  return sub_1400030E4(v1);
}

//----- (00000001400033A8) ----------------------------------------------------
void __fastcall sub_1400033A8(__int64 a1)
{
  __int64 v1; // rbx@1
  unsigned int v2; // eax@1
  int v3; // ebp@1
  unsigned int v4; // ebx@3
  __int64 v5; // rdi@3
  unsigned int v6; // eax@5
  char v7; // cf@10
  char v8; // zf@10

  v1 = a1;
  v2 = do_vmread(0x4404u);
  v3 = (v2 >> 8) & 7;
  if ( v3 == 3 )
  {
    switch ( (unsigned __int8)v2 )
    {
      case 0xEu:
        v4 = do_vmread(0x4406u);
        v5 = do_vmread(0x6400u);
        sub_14000481C(3, 0xEu, 1u, v4);
        sub_140001536(v5);
        break;
      case 0xDu:
        v6 = do_vmread(0x4406u);
        sub_14000481C(3, 0xDu, 1u, v6);
        break;
      case 1u:
        sub_1400030E4(v1);
        break;
    }
  }
  else if ( v3 == 6 && (unsigned __int8)v2 == 3 )
  {
    sub_14000481C(6, 3u, 0, 0);
    do_vmwrite(v7, v8, 1i64);
  }
}

//----- (000000014000347C) ----------------------------------------------------
char __fastcall sub_14000347C(__int64 a1)
{
  __int64 v1; // rbp@1
  unsigned int v2; // ebx@1
  __int64 v3; // rsi@1
  __int64 v4; // r14@1
  __int64 v5; // rdi@3
  __int64 v6; // rcx@11
  unsigned int v7; // ecx@19
  __int64 v8; // rdi@26
  unsigned __int64 v9; // rsi@28
  int v10; // ebx@28
  int v11; // ebx@29
  bool v12; // cf@30
  int v13; // ebx@30
  char v14; // cf@32
  char v15; // zf@32
  __int64 v16; // rax@35
  unsigned int v17; // ecx@35

  v1 = a1;
  v2 = do_vmread(0x440Eu);
  v3 = 0i64;
  v4 = do_vmread(0x6400u);
  if ( !_bittest((const signed int *)&v2, 0x1Bu) )
    v3 = *(_QWORD *)sub_140004878((v2 >> 23) & 0xF, v1);
  v5 = 0i64;
  if ( !_bittest((const signed int *)&v2, 0x16u) )
  {
    v5 = *(_QWORD *)sub_140004878((v2 >> 18) & 0xF, v1);
    if ( v2 & 3 )
    {
      switch ( v2 & 3 )
      {
        case 1u:
          v5 *= 2i64;
          break;
        case 2u:
          v5 *= 4i64;
          break;
        case 3u:
          v5 *= 8i64;
          break;
      }
    }
  }
  v6 = 0i64;
  if ( !((v2 >> 15) & 7) )
  {
    v7 = 26630;
    goto LABEL_25;
  }
  if ( ((v2 >> 15) & 7) == 1 )
  {
    v7 = 26632;
    goto LABEL_25;
  }
  if ( ((v2 >> 15) & 7) == 2 )
  {
    v7 = 26634;
    goto LABEL_25;
  }
  if ( ((v2 >> 15) & 7) == 3 )
  {
    v7 = 26636;
    goto LABEL_25;
  }
  if ( ((v2 >> 15) & 7) == 4 )
  {
    v7 = 26638;
    goto LABEL_25;
  }
  if ( ((v2 >> 15) & 7) == 5 )
  {
    v7 = 26640;
LABEL_25:
    v6 = do_vmread(v7);
    goto LABEL_26;
  }
  if ( !(_BYTE)KdDebuggerNotPresent )
    __debugbreak();
LABEL_26:
  v8 = v4 + v3 + v6 + v5;
  if ( (v2 & 0x380) == 128 )
    v8 = (unsigned int)v8;
  v9 = __readcr3();
  __writecr3(do_vmread(0x6802u));
  v10 = (v2 >> 28) & 3;
  if ( !v10 )
  {
    v16 = do_vmread(0x6816u);
    v17 = 18448;
    goto LABEL_37;
  }
  v11 = v10 - 1;
  if ( !v11 )
  {
    v16 = do_vmread(0x6818u);
    v17 = 18450;
LABEL_37:
    *(_QWORD *)(v8 + 2) = v16;
    *(_WORD *)v8 = do_vmread(v17);
    goto LABEL_38;
  }
  v12 = (unsigned int)v11 < 1;
  v13 = v11 - 1;
  if ( !v13 )
  {
    do_vmwrite(v12, 1, *(_QWORD *)(v8 + 2));
    goto LABEL_34;
  }
  if ( v13 == 1 )
  {
    do_vmwrite(0, 1, *(_QWORD *)(v8 + 2));
LABEL_34:
    do_vmwrite(v14, v15, *(_WORD *)v8);
  }
LABEL_38:
  __writecr3(v9);
  return sub_1400030E4(v1);
}

//----- (0000000140003634) ----------------------------------------------------
char __fastcall sub_140003634(__int64 a1)
{
  __int64 v1; // rbp@1
  unsigned int v2; // ebx@1
  __int64 v3; // r14@1
  _WORD *v4; // rdi@2
  __int64 v5; // rsi@3
  __int64 v6; // rdi@5
  __int64 v7; // rcx@13
  unsigned int v8; // ecx@21
  unsigned __int64 v9; // rsi@30
  int v10; // ebx@30
  int v11; // ebx@31
  bool v12; // cf@32
  int v13; // ebx@32
  unsigned int v14; // ebx@34
  __int64 v15; // rax@34
  unsigned int v16; // ecx@36

  v1 = a1;
  v2 = do_vmread(0x440Eu);
  v3 = do_vmread(0x6400u);
  if ( _bittest((const signed int *)&v2, 0xAu) )
  {
    v4 = (_WORD *)sub_140004878((v2 >> 3) & 0xF, v1);
    goto LABEL_30;
  }
  v5 = 0i64;
  if ( !_bittest((const signed int *)&v2, 0x1Bu) )
    v5 = *(_QWORD *)sub_140004878((v2 >> 23) & 0xF, v1);
  v6 = 0i64;
  if ( !_bittest((const signed int *)&v2, 0x16u) )
  {
    v6 = *(_QWORD *)sub_140004878((v2 >> 18) & 0xF, v1);
    if ( v2 & 3 )
    {
      switch ( v2 & 3 )
      {
        case 1u:
          v6 *= 2i64;
          break;
        case 2u:
          v6 *= 4i64;
          break;
        case 3u:
          v6 *= 8i64;
          break;
      }
    }
  }
  v7 = 0i64;
  if ( (v2 >> 15) & 7 )
  {
    switch ( (v2 >> 15) & 7 )
    {
      case 1u:
        v8 = 26632;
        break;
      case 2u:
        v8 = 26634;
        break;
      case 3u:
        v8 = 26636;
        break;
      case 4u:
        v8 = 26638;
        break;
      default:
        if ( ((v2 >> 15) & 7) != 5 )
        {
          if ( !(_BYTE)KdDebuggerNotPresent )
            __debugbreak();
          goto LABEL_28;
        }
        v8 = 26640;
        break;
    }
  }
  else
  {
    v8 = 26630;
  }
  v7 = do_vmread(v8);
LABEL_28:
  v4 = (_WORD *)(v3 + v5 + v7 + v6);
  if ( (v2 & 0x380) == 128 )
    v4 = (_WORD *)(unsigned int)v4;
LABEL_30:
  v9 = __readcr3();
  __writecr3(do_vmread(0x6802u));
  v10 = (v2 >> 28) & 3;
  if ( !v10 )
  {
    v16 = 2060;
    goto LABEL_38;
  }
  v11 = v10 - 1;
  if ( !v11 )
  {
    v16 = 2062;
LABEL_38:
    *v4 = do_vmread(v16);
    goto LABEL_39;
  }
  v12 = (unsigned int)v11 < 1;
  v13 = v11 - 1;
  if ( v13 )
  {
    if ( v13 == 1 )
    {
      do_vmwrite(0, 1, *v4);
      v14 = *v4;
      v15 = do_vmread(0x6816u);
      *(_QWORD *)(v15 + 8 * ((unsigned __int64)v14 >> 3)) |= 0x20000000000ui64;
    }
  }
  else
  {
    do_vmwrite(v12, 1, *v4);
  }
LABEL_39:
  __writecr3(v9);
  return sub_1400030E4(v1);
}

//----- (0000000140003804) ----------------------------------------------------
__int64 sub_140003804()
{
  return do_vmread(0x6400u);
}

//----- (0000000140003810) ----------------------------------------------------
void __fastcall VMCALL_HANDLER(__int64 a1)
{
  __int64 v1; // rsi@1
  signed int v2; // ebx@1
  __int64 v3; // rdi@1
  unsigned __int64 v4; // r15@1
  __int64 v5; // r14@1
  unsigned __int64 v6; // rbp@1
  int v7; // ebx@3
  int v8; // ebx@4
  int v9; // ebx@5
  int v10; // ebx@6
  __int64 v11; // rbx@8
  unsigned __int64 v12; // rax@8
  _QWORD *v13; // rax@8
  __int64 v14; // rbx@17
  unsigned __int64 v15; // rax@19
  _QWORD *v16; // rax@19
  int v17; // ebx@20
  int v18; // ebx@21
  int v19; // ebx@22
  int v20; // ebx@23
  char v21; // bl@25
  char v22; // cf@26
  char v23; // zf@26
  __int64 v24; // rbx@28
  unsigned __int64 v25; // rax@28
  _QWORD *v26; // rax@28
  __int64 v27; // rbx@30
  unsigned __int64 v28; // rax@30
  _QWORD *v29; // rax@30

  v1 = a1;
  v2 = *(_DWORD *)(*(_QWORD *)a1 + 112i64);
  v3 = *(_QWORD *)(*(_QWORD *)a1 + 104i64);
  v4 = *(_DWORD *)(*(_QWORD *)a1 + 56i64);
  v5 = do_vmread(0x6802u);
  v6 = __readcr3();
  if ( v2 <= 325612627 )
  {
    if ( v2 == 325612627 )
    {
      v14 = *(_QWORD *)(*(_QWORD *)v1 + 136i64);
      if ( MemoryDescriptorList )
      {
        MmUnlockPages(MemoryDescriptorList);
        MemoryDescriptorList = 0i64;
      }
      __writecr3(v5);
      sub_140004C80((signed __int64 *)v3, 0i64, v4);
      LODWORD(v15) = MmGetPhysicalAddress(v3);
      v16 = (_QWORD *)sub_1400026B0(*(_QWORD *)(v14 + 32), v15);
      *v16 |= 6ui64;
      goto LABEL_9;
    }
    v7 = v2 - 325611616;
    if ( v7 )
    {
      v8 = v7 - 1;
      if ( v8 )
      {
        v9 = v8 - 1;
        if ( v9 )
        {
          v10 = v9 - 1;
          if ( v10 )
          {
            if ( v10 == 1006 )
            {
              v11 = *(_QWORD *)(*(_QWORD *)v1 + 136i64);
              __writecr3(v5);
              sub_140004988((void *)v3, 0x1000u);
              LODWORD(v12) = MmGetPhysicalAddress(v3);
              v13 = (_QWORD *)sub_1400026B0(*(_QWORD *)(v11 + 32), v12);
              *v13 &= 0xFFFFFFFFFFFFFFF8ui64;
              goto LABEL_9;
            }
LABEL_25:
            v21 = 3;
LABEL_26:
            sub_14000481C(v21, 6u, 0, 0);
            do_vmwrite(v22, v23, 3i64);
            return;
          }
          __writecr3(v5);
          *(_DWORD *)v3 = -487976406;
          *(_DWORD *)(v3 + 4) = 388096738;
          *(_DWORD *)(v3 + 8) = -488447238;
          *(_DWORD *)(v3 + 12) = -488447445;
          *(_DWORD *)(v3 + 16) = -488447006;
          *(_DWORD *)(v3 + 20) = -488447262;
          *(_DWORD *)(v3 + 24) = -487969822;
          *(_DWORD *)(v3 + 28) = -488447262;
          *(_DWORD *)(v3 + 32) = -488447262;
          *(_DWORD *)(v3 + 36) = -433331486;
          *(_DWORD *)(v3 + 40) = -488447262;
          *(_DWORD *)(v3 + 44) = -488447262;
          *(_DWORD *)(v3 + 48) = -119348510;
          *(_DWORD *)(v3 + 52) = -488455668;
          *(_DWORD *)(v3 + 56) = 201850338;
          *(_DWORD *)(v3 + 60) = -488447262;
          *(_DWORD *)(v3 + 64) = -487978245;
          *(_DWORD *)(v3 + 68) = 120644322;
          *(_DWORD *)(v3 + 72) = -1039337462;
          *(_DWORD *)(v3 + 76) = -35462430;
          *(_DWORD *)(v3 + 80) = -488436729;
          *(_DWORD *)(v3 + 84) = 120644322;
          *(_DWORD *)(v3 + 88) = -1039337462;
          *(_DWORD *)(v3 + 92) = -35462430;
          *(_DWORD *)(v3 + 96) = -488633337;
          *(_DWORD *)(v3 + 100) = 120644322;
          *(_DWORD *)(v3 + 104) = -1039337462;
          *(_DWORD *)(v3 + 108) = -35462430;
          *(_DWORD *)(v3 + 112) = -488567801;
          *(_DWORD *)(v3 + 116) = 120644322;
          *(_DWORD *)(v3 + 120) = -1039337462;
          *(_DWORD *)(v3 + 124) = -35462430;
          *(_DWORD *)(v3 + 128) = -488240123;
          *(_DWORD *)(v3 + 132) = 182510306;
          *(_DWORD *)(v3 + 136) = 117780487;
          *(_DWORD *)(v3 + 140) = -487979206;
          *(_DWORD *)(v3 + 144) = -500440350;
          *(_DWORD *)(v3 + 148) = -471670046;
          *(_DWORD *)(v3 + 152) = -488447262;
          *(_DWORD *)(v3 + 156) = -119348510;
          *(_DWORD *)(v3 + 160) = -488455668;
          *(_DWORD *)(v3 + 164) = 201850338;
          *(_DWORD *)(v3 + 168) = -488447262;
          *(_DWORD *)(v3 + 172) = -492566621;
          *(_DWORD *)(v3 + 176) = -223288606;
          *(_DWORD *)(v3 + 180) = -488494110;
          *(_DWORD *)(v3 + 184) = -488447262;
          *(_DWORD *)(v3 + 188) = -488447262;
          *(_DWORD *)(v3 + 192) = 217637602;
          *(_DWORD *)(v3 + 196) = -488447294;
          *(_DWORD *)(v3 + 200) = -435419139;
          *(_DWORD *)(v3 + 204) = -1545411870;
          *(_DWORD *)(v3 + 208) = -488451833;
          *(_DWORD *)(v3 + 212) = -487411486;
          *(_DWORD *)(v3 + 216) = -488447445;
          *(_DWORD *)(v3 + 220) = -488447262;
          *(_DWORD *)(v3 + 224) = -488447262;
          *(_DWORD *)(v3 + 228) = -487939870;
          *(_DWORD *)(v3 + 232) = -477502750;
          *(_DWORD *)(v3 + 236) = -223288606;
          *(_DWORD *)(v3 + 240) = -488494110;
          *(_DWORD *)(v3 + 244) = -488447262;
          *(_DWORD *)(v3 + 248) = -488447262;
          *(_DWORD *)(v3 + 252) = 217637602;
          *(_DWORD *)(v3 + 256) = -488447294;
          *(_DWORD *)(v3 + 260) = -536081667;
          *(_DWORD *)(v3 + 264) = -119348510;
          *(_DWORD *)(v3 + 268) = -488455668;
          *(_DWORD *)(v3 + 272) = 201719266;
          *(_DWORD *)(v3 + 276) = -488447263;
          *(_DWORD *)(v3 + 280) = 805767904;
          *(_DWORD *)(v3 + 284) = 128124677;
          *(_DWORD *)(v3 + 288) = -488447388;
          *(_DWORD *)(v3 + 292) = 736293552;
          *(_DWORD *)(v3 + 296) = -488447262;
          *(_DWORD *)(v3 + 300) = -488447262;
          *(_DWORD *)(v3 + 304) = -488447262;
          *(_DWORD *)(v3 + 308) = -490599176;
          *(_DWORD *)(v3 + 312) = 184410850;
          *(_DWORD *)(v3 + 316) = -488447220;
          *(_DWORD *)(v3 + 320) = -1039337246;
          *(_DWORD *)(v3 + 324) = -35462430;
          *(_DWORD *)(v3 + 328) = -488633339;
          *(_DWORD *)(v3 + 332) = 182510306;
          *(_DWORD *)(v3 + 336) = 117780487;
          *(_DWORD *)(v3 + 340) = -498989149;
          *(_DWORD *)(v3 + 344) = -223288606;
          *(_DWORD *)(v3 + 348) = -488494110;
          *(_DWORD *)(v3 + 352) = -488447262;
          *(_DWORD *)(v3 + 356) = -488447262;
          *(_DWORD *)(v3 + 360) = -486939934;
          *(_DWORD *)(v3 + 364) = 602071778;
          *(_DWORD *)(v3 + 368) = -488441321;
          *(_WORD *)(v3 + 372) = -7198;
        }
        else
        {
          __writecr3(v5);
          *(_DWORD *)v3 = -487976406;
          *(_DWORD *)(v3 + 4) = 388096738;
          *(_DWORD *)(v3 + 8) = -488447286;
          *(_DWORD *)(v3 + 12) = -488447445;
          *(_DWORD *)(v3 + 16) = -488447006;
          *(_DWORD *)(v3 + 20) = -488447262;
          *(_DWORD *)(v3 + 24) = -488428574;
          *(_DWORD *)(v3 + 28) = -496835870;
          *(_DWORD *)(v3 + 32) = -488447262;
          *(_DWORD *)(v3 + 36) = -433331486;
          *(_DWORD *)(v3 + 40) = 1206051554;
          *(_DWORD *)(v3 + 44) = -488447262;
          *(_DWORD *)(v3 + 48) = 736289506;
          *(_DWORD *)(v3 + 52) = -488447257;
          *(_DWORD *)(v3 + 56) = -488447405;
          *(_DWORD *)(v3 + 60) = -488447262;
          *(_DWORD *)(v3 + 64) = -488446933;
          *(_DWORD *)(v3 + 68) = -488447774;
          *(_DWORD *)(v3 + 72) = -488447262;
          *(_DWORD *)(v3 + 76) = -488297502;
          *(_DWORD *)(v3 + 80) = -491855134;
          *(_DWORD *)(v3 + 84) = -488447262;
          *(_DWORD *)(v3 + 88) = -366222622;
          *(_DWORD *)(v3 + 92) = 669180642;
          *(_DWORD *)(v3 + 96) = -488447262;
          *(_DWORD *)(v3 + 100) = 736289506;
          *(_DWORD *)(v3 + 104) = -488447250;
          *(_DWORD *)(v3 + 108) = -488447262;
          *(_DWORD *)(v3 + 112) = -488447262;
          *(_DWORD *)(v3 + 116) = -69011534;
          *(_DWORD *)(v3 + 120) = -488444409;
          *(_DWORD *)(v3 + 124) = -486067230;
          *(_DWORD *)(v3 + 128) = 987947746;
          *(_DWORD *)(v3 + 132) = -488444409;
          *(_DWORD *)(v3 + 136) = -487677726;
          *(_DWORD *)(v3 + 140) = -488119582;
          *(_DWORD *)(v3 + 144) = -2018057502;
          *(_DWORD *)(v3 + 148) = -300744734;
          *(_DWORD *)(v3 + 152) = -119348510;
          *(_DWORD *)(v3 + 156) = -488451572;
          *(_DWORD *)(v3 + 160) = 201850338;
          *(_DWORD *)(v3 + 164) = -488447470;
          *(_DWORD *)(v3 + 168) = -486146846;
          *(_DWORD *)(v3 + 172) = 937616098;
          *(_DWORD *)(v3 + 176) = 119670023;
          *(_DWORD *)(v3 + 180) = -488447312;
          *(_DWORD *)(v3 + 184) = -488443147;
          *(_DWORD *)(v3 + 188) = -234488606;
          *(_DWORD *)(v3 + 192) = -1907998;
          *(_DWORD *)(v3 + 196) = -488444404;
          *(_DWORD *)(v3 + 200) = 201850082;
          *(_DWORD *)(v3 + 204) = -488447258;
          *(_DWORD *)(v3 + 208) = -1341717086;
          *(_DWORD *)(v3 + 212) = -500440334;
          *(_DWORD *)(v3 + 216) = -488447262;
          *(_DWORD *)(v3 + 220) = -488447262;
          *(_DWORD *)(v3 + 224) = -52239646;
          *(_DWORD *)(v3 + 228) = -488447225;
          *(_DWORD *)(v3 + 232) = -1341705246;
          *(_DWORD *)(v3 + 236) = -169680158;
          *(_DWORD *)(v3 + 240) = -488447261;
          *(_DWORD *)(v3 + 244) = -115514958;
          *(_DWORD *)(v3 + 248) = -488447262;
          *(_DWORD *)(v3 + 252) = -490072285;
          *(_WORD *)(v3 + 256) = -7454;
          *(_BYTE *)(v3 + 258) = -29;
        }
      }
      else
      {
        __writecr3(v5);
        *(_DWORD *)v3 = -487976406;
        *(_DWORD *)(v3 + 4) = 388096738;
        *(_DWORD *)(v3 + 8) = -488447286;
        *(_DWORD *)(v3 + 12) = -488447445;
        *(_DWORD *)(v3 + 16) = -488447006;
        *(_DWORD *)(v3 + 20) = -488447262;
        *(_DWORD *)(v3 + 24) = -487969822;
        *(_DWORD *)(v3 + 28) = -488447262;
        *(_DWORD *)(v3 + 32) = -488447262;
        *(_DWORD *)(v3 + 36) = -349445406;
        *(_DWORD *)(v3 + 40) = -438115614;
        *(_DWORD *)(v3 + 44) = -488447262;
        *(_DWORD *)(v3 + 48) = 736289506;
        *(_DWORD *)(v3 + 52) = -488447256;
        *(_DWORD *)(v3 + 56) = -488447288;
        *(_DWORD *)(v3 + 60) = -488447262;
        *(_DWORD *)(v3 + 64) = -488445653;
        *(_DWORD *)(v3 + 68) = -488447518;
        *(_DWORD *)(v3 + 72) = -488447262;
        *(_DWORD *)(v3 + 76) = -487707678;
        *(_DWORD *)(v3 + 80) = -492379422;
        *(_DWORD *)(v3 + 84) = -488447262;
        *(_DWORD *)(v3 + 88) = -282336542;
        *(_DWORD *)(v3 + 92) = -454892830;
        *(_DWORD *)(v3 + 96) = -488447262;
        *(_DWORD *)(v3 + 100) = 736289506;
        *(_DWORD *)(v3 + 104) = -488447252;
        *(_DWORD *)(v3 + 108) = -488447321;
        *(_DWORD *)(v3 + 112) = -488447262;
        *(_DWORD *)(v3 + 116) = -488444629;
        *(_DWORD *)(v3 + 120) = -488446494;
        *(_DWORD *)(v3 + 124) = -488447262;
        *(_DWORD *)(v3 + 128) = -487445534;
        *(_DWORD *)(v3 + 132) = -490151198;
        *(_DWORD *)(v3 + 136) = -488447262;
        *(_DWORD *)(v3 + 140) = -97787166;
        *(_DWORD *)(v3 + 144) = -1746738462;
        *(_DWORD *)(v3 + 148) = -488447262;
        *(_DWORD *)(v3 + 152) = 736289506;
        *(_DWORD *)(v3 + 156) = -488447234;
        *(_DWORD *)(v3 + 160) = -488447262;
        *(_DWORD *)(v3 + 164) = -488447262;
        *(_DWORD *)(v3 + 168) = -69011534;
        *(_DWORD *)(v3 + 172) = -488440313;
        *(_DWORD *)(v3 + 176) = -486067230;
        *(_DWORD *)(v3 + 180) = 987947746;
        *(_DWORD *)(v3 + 184) = -488440313;
        *(_DWORD *)(v3 + 188) = -486629150;
        *(_DWORD *)(v3 + 192) = -487857438;
        *(_DWORD *)(v3 + 196) = -1581849886;
        *(_DWORD *)(v3 + 200) = -32309278;
        *(_DWORD *)(v3 + 204) = -119348510;
        *(_DWORD *)(v3 + 208) = -488451572;
        *(_DWORD *)(v3 + 212) = 201719266;
        *(_DWORD *)(v3 + 216) = -488447470;
        *(_DWORD *)(v3 + 220) = -100139294;
        *(_DWORD *)(v3 + 224) = 937616098;
        *(_DWORD *)(v3 + 228) = 218040069;
        *(_DWORD *)(v3 + 232) = -488447234;
        *(_DWORD *)(v3 + 236) = -368310276;
        *(_DWORD *)(v3 + 240) = -1562189086;
        *(_DWORD *)(v3 + 244) = -223344891;
        *(_DWORD *)(v3 + 248) = -488494110;
        *(_DWORD *)(v3 + 252) = -488447262;
        *(_DWORD *)(v3 + 256) = -488447262;
        *(_DWORD *)(v3 + 260) = 1202905826;
        *(_DWORD *)(v3 + 264) = -488441571;
        *(_DWORD *)(v3 + 268) = 388227810;
        *(_DWORD *)(v3 + 272) = -488447286;
        *(_BYTE *)(v3 + 276) = -29;
      }
    }
    else
    {
      __writecr3(v5);
      *(_DWORD *)v3 = -487976406;
      *(_DWORD *)(v3 + 4) = 388096738;
      *(_DWORD *)(v3 + 8) = -488447238;
      *(_DWORD *)(v3 + 12) = -488447445;
      *(_DWORD *)(v3 + 16) = -488447006;
      *(_DWORD *)(v3 + 20) = -488447262;
      *(_DWORD *)(v3 + 24) = -1039337246;
      *(_DWORD *)(v3 + 28) = -35462430;
      *(_DWORD *)(v3 + 32) = -488502265;
      *(_DWORD *)(v3 + 36) = 128180962;
      *(_DWORD *)(v3 + 40) = -488447307;
      *(_DWORD *)(v3 + 44) = 736293552;
      *(_DWORD *)(v3 + 48) = -488447262;
      *(_DWORD *)(v3 + 52) = -488447262;
      *(_DWORD *)(v3 + 56) = -488447262;
      *(_DWORD *)(v3 + 60) = -490599176;
      *(_DWORD *)(v3 + 64) = 134079202;
      *(_DWORD *)(v3 + 68) = -488447220;
      *(_DWORD *)(v3 + 72) = -2029542430;
      *(_DWORD *)(v3 + 76) = -1327308062;
      *(_DWORD *)(v3 + 80) = -500440334;
      *(_DWORD *)(v3 + 84) = -488447262;
      *(_DWORD *)(v3 + 88) = -488447262;
      *(_DWORD *)(v3 + 92) = -119348510;
      *(_DWORD *)(v3 + 96) = -488455668;
      *(_DWORD *)(v3 + 100) = 201850338;
      *(_DWORD *)(v3 + 104) = -488447264;
      *(_DWORD *)(v3 + 108) = -489289821;
      *(_DWORD *)(v3 + 112) = -223288606;
      *(_DWORD *)(v3 + 116) = -488494110;
      *(_DWORD *)(v3 + 120) = -488447262;
      *(_DWORD *)(v3 + 124) = -488447262;
      *(_DWORD *)(v3 + 128) = 217637602;
      *(_DWORD *)(v3 + 132) = -488447294;
      *(_DWORD *)(v3 + 136) = -519305219;
      *(_DWORD *)(v3 + 140) = -1545411870;
      *(_DWORD *)(v3 + 144) = -488468473;
      *(_DWORD *)(v3 + 148) = -487411486;
      *(_DWORD *)(v3 + 152) = -488447445;
      *(_DWORD *)(v3 + 156) = -488447262;
      *(_DWORD *)(v3 + 160) = -488447262;
      *(_DWORD *)(v3 + 164) = -1039337246;
      *(_DWORD *)(v3 + 168) = -35462430;
      *(_DWORD *)(v3 + 172) = -488240121;
      *(_DWORD *)(v3 + 176) = 128180962;
      *(_DWORD *)(v3 + 180) = -488447299;
      *(_DWORD *)(v3 + 184) = 736293552;
      *(_DWORD *)(v3 + 188) = -488447262;
      *(_DWORD *)(v3 + 192) = -488447262;
      *(_DWORD *)(v3 + 196) = -488447262;
      *(_DWORD *)(v3 + 200) = -488447239;
      *(_DWORD *)(v3 + 204) = -99146782;
      *(_DWORD *)(v3 + 208) = -471670046;
    }
    sub_140004B18((_BYTE *)v3, v4);
    goto LABEL_9;
  }
  v17 = v2 - 325612629;
  if ( v17 )
  {
    v18 = v17 - 1;
    if ( v18 )
    {
      v19 = v18 - 1;
      if ( !v19 )
      {
        __writecr3(v5);
        if ( !sub_140004A3C(*(_QWORD *)(*(_QWORD *)v1 + 136i64), v3) )
        {
          sub_14000481C(3, 6u, 0, 0);
          do_vmwrite(v22, v23, 3i64);
          goto LABEL_10;
        }
LABEL_9:
        sub_1400047EC(v1);
LABEL_10:
        __writecr3(v6);
LABEL_11:
        sub_140002D30();
        return;
      }
      v20 = v19 - 1;
      if ( !v20 )
      {
        v27 = *(_QWORD *)(*(_QWORD *)v1 + 136i64);
        LODWORD(v28) = MmGetPhysicalAddress(v3);
        v29 = (_QWORD *)sub_1400026B0(*(_QWORD *)(v27 + 32), v28);
        *v29 &= 0xFFFFFFFFFFFFFFFDui64;
        goto LABEL_11;
      }
      if ( v20 != 1 )
        goto LABEL_25;
      v24 = *(_QWORD *)(*(_QWORD *)v1 + 136i64);
      LODWORD(v25) = MmGetPhysicalAddress(v3);
      v26 = (_QWORD *)sub_1400026B0(*(_QWORD *)(v24 + 32), v25);
      *v26 &= 0xFFFFFFFFFFFFFFFEui64;
    }
    else if ( !sub_140004A3C(*(_QWORD *)(*(_QWORD *)v1 + 136i64), *(_QWORD *)(v3 + 24)) )
    {
      sub_14000481C(3, 6u, 0, 0);
      do_vmwrite(v22, v23, 3i64);
      goto LABEL_11;
    }
    sub_1400047EC(v1);
    goto LABEL_11;
  }
  v21 = 3;
  if ( ((unsigned int)do_vmread(0x4818u) >> 5) & 3 )
    goto LABEL_26;
  sub_140004440(v1, (_QWORD *)v3);
}
// 140002F70: using guessed type int __fastcall MmGetPhysicalAddress(_QWORD);

//----- (0000000140004440) ----------------------------------------------------
void __fastcall sub_140004440(__int64 a1, _QWORD *a2)
{
  __int64 v2; // r15@1
  _QWORD *v3; // r14@1
  __int64 v4; // rax@1
  __int64 v5; // [sp+0h] [bp-68h]@1
  __int16 v6; // [sp+20h] [bp-48h]@1
  __int64 v7; // [sp+22h] [bp-46h]@1
  char v8[6]; // [sp+30h] [bp-38h]@1
  __int64 v9; // [sp+40h] [bp-28h]@1

  v2 = a1;
  v3 = a2;
  v6 = do_vmread(0x4810u);
  v7 = do_vmread(0x6816u);
  *(_WORD *)v8 = do_vmread(0x4812u);
  *(_QWORD *)&v8[2] = do_vmread(0x6818u);
  sub_1400014E4(&v6);
  __lidt(v8);
  *v3 = *(_QWORD *)(*(_QWORD *)v2 + 136i64);
  v4 = do_vmread(0x440Cu);
  *(_QWORD *)(v2 + 8) &= 0xFFFFFFFFFFFFF72Aui64;
  *(_QWORD *)(*(_QWORD *)v2 + 112i64) = v4 + *(_QWORD *)(v2 + 16);
  *(_QWORD *)(*(_QWORD *)v2 + 104i64) = *(_QWORD *)(*(_QWORD *)v2 + 88i64);
  *(_QWORD *)(*(_QWORD *)v2 + 120i64) = *(_QWORD *)(v2 + 8);
  *(_BYTE *)(v2 + 33) = 0;
  sub_140004B50((unsigned __int64)&v5 ^ v9);
}

//----- (00000001400047EC) ----------------------------------------------------
char __fastcall sub_1400047EC(__int64 a1)
{
  __int64 v1; // rbx@1
  bool v2; // zf@1
  __int64 v3; // rdx@1

  v1 = a1;
  v3 = *(_QWORD *)(a1 + 8) & 0xFFFFFFFFFFFFF72Aui64;
  v2 = v3 == 0;
  *(_QWORD *)(a1 + 8) = v3;
  do_vmwrite(0, v2, v3);
  return sub_1400030E4(v1);
}

//----- (000000014000481C) ----------------------------------------------------
char __fastcall sub_14000481C(char a1, unsigned __int8 a2, unsigned __int8 a3, unsigned int a4)
{
  unsigned __int8 v4; // bl@1
  unsigned int v5; // edi@1
  unsigned int v6; // edx@1
  char result; // al@1

  v4 = a3;
  v5 = a4;
  v6 = ((a1 & 7 | 8 * (a3 | 0xFFF00000)) << 8) | a2;
  result = do_vmwrite(0, v6 == 0, v6);
  if ( v4 )
    result = do_vmwrite(0, v4 == 0, v5);
  return result;
}

//----- (0000000140004878) ----------------------------------------------------
signed __int64 __fastcall sub_140004878(unsigned int a1, __int64 a2)
{
  __int64 v2; // r8@1
  int v3; // ecx@4
  int v4; // ecx@5
  int v5; // ecx@6
  int v6; // ecx@7
  int v7; // ecx@8
  int v8; // ecx@9
  int v9; // ecx@20
  int v10; // ecx@21
  int v11; // ecx@22
  int v12; // ecx@23
  int v13; // ecx@24
  int v14; // ecx@25

  v2 = 0i64;
  if ( a1 > 8 )
  {
    v9 = a1 - 9;
    if ( !v9 )
      return *(_QWORD *)a2 + 48i64;
    v10 = v9 - 1;
    if ( !v10 )
      return *(_QWORD *)a2 + 40i64;
    v11 = v10 - 1;
    if ( !v11 )
      return *(_QWORD *)a2 + 32i64;
    v12 = v11 - 1;
    if ( !v12 )
      return *(_QWORD *)a2 + 24i64;
    v13 = v12 - 1;
    if ( !v13 )
      return *(_QWORD *)a2 + 16i64;
    v14 = v13 - 1;
    if ( !v14 )
      return *(_QWORD *)a2 + 8i64;
    if ( v14 == 1 )
      return *(_QWORD *)a2;
  }
  else
  {
    if ( a1 == 8 )
      return *(_QWORD *)a2 + 56i64;
    if ( !a1 )
      return *(_QWORD *)a2 + 120i64;
    v3 = a1 - 1;
    if ( !v3 )
      return *(_QWORD *)a2 + 112i64;
    v4 = v3 - 1;
    if ( !v4 )
      return *(_QWORD *)a2 + 104i64;
    v5 = v4 - 1;
    if ( !v5 )
      return *(_QWORD *)a2 + 96i64;
    v6 = v5 - 1;
    if ( !v6 )
      return *(_QWORD *)a2 + 88i64;
    v7 = v6 - 1;
    if ( !v7 )
      return *(_QWORD *)a2 + 80i64;
    v8 = v7 - 1;
    if ( !v8 )
      return *(_QWORD *)a2 + 72i64;
    if ( v8 == 1 )
      return *(_QWORD *)a2 + 64i64;
  }
  if ( !(_BYTE)KdDebuggerNotPresent )
    __debugbreak();
  return v2;
}

//----- (0000000140004988) ----------------------------------------------------
__int64 __fastcall sub_140004988(void *a1, ULONG a2)
{
  signed int v2; // edi@1
  struct _MDL *v3; // rax@1
  struct _MDL *v4; // rbx@1
  PVOID v5; // rax@4

  v2 = -1073741823;
  v3 = IoAllocateMdl(a1, a2, 0, 1u, 0i64);
  v4 = v3;
  if ( v3 )
  {
    MmProbeAndLockPages(v3, 0, 0);
    if ( v4->MdlFlags & 5 )
      v5 = v4->MappedSystemVa;
    else
      v5 = MmMapLockedPagesSpecifyCache(v4, 0, MmCached, 0i64, 0, NormalPagePriority);
    if ( v5 )
    {
      MemoryDescriptorList = v4;
      v2 = 0;
    }
    else
    {
      MmUnlockPages(v4);
      IoFreeMdl(v4);
    }
  }
  else
  {
    v2 = -1073741670;
  }
  return (unsigned int)v2;
}

//----- (0000000140004A3C) ----------------------------------------------------
char __fastcall sub_140004A3C(__int64 a1, __int64 a2)
{
  __int64 v2; // r14@1
  __int64 v3; // r13@1
  char v4; // bl@1
  unsigned int v5; // er12@1
  __int64 v6; // rsi@1
  signed __int64 v7; // rdx@1
  unsigned int v8; // edi@1
  signed __int64 v9; // r15@3
  unsigned __int64 v10; // rdi@4
  unsigned __int64 i; // rbx@8
  unsigned __int64 v12; // rax@10
  _QWORD *v13; // rax@10
  signed __int64 v15; // [sp+70h] [bp+18h]@1

  v2 = a2;
  v3 = a1;
  v4 = 0;
  v5 = 0;
  v6 = *(_DWORD *)(a2 + 60);
  v7 = *(_WORD *)(v6 + a2 + 20) + v6 + a2 + 24;
  v15 = v7;
  v8 = 0;
  while ( v8 < *(_WORD *)(v6 + v2 + 6) )
  {
    v9 = v7 + 40i64 * v8;
    if ( !strcmp((const char *)v9, ".text") )
    {
      v5 = *(_DWORD *)(v9 + 16);
      v10 = v2 + *(_DWORD *)(v9 + 12);
      goto LABEL_7;
    }
    ++v8;
    v7 = v15;
  }
  v10 = 0i64;
LABEL_7:
  if ( v10 )
  {
    for ( i = v10; i < v10 + v5; i += 4096i64 )
    {
      LODWORD(v12) = MmGetPhysicalAddress(i);
      v13 = (_QWORD *)sub_1400026B0(*(_QWORD *)(v3 + 32), v12);
      *v13 &= 0xFFFFFFFFFFFFFFFDui64;
    }
    v4 = 1;
  }
  return v4;
}
// 140002F70: using guessed type int __fastcall MmGetPhysicalAddress(_QWORD);

//----- (0000000140004B18) ----------------------------------------------------
void __fastcall sub_140004B18(_BYTE *a1, unsigned int a2)
{
  __int64 v2; // rax@2

  dword_140008CB0 = 1795536354;
  if ( a2 )
  {
    v2 = a2;
    do
    {
      *a1++ ^= 0xE2u;
      --v2;
    }
    while ( v2 );
  }
}
// 140008CB0: using guessed type int dword_140008CB0;

//----- (0000000140004B50) ----------------------------------------------------
void __fastcall sub_140004B50(ULONG_PTR BugCheckParameter1)
{
  __int64 v1; // rcx@2

  if ( BugCheckParameter1 != _security_cookie )
LABEL_4:
    KeBugCheckEx(0xF7u, BugCheckParameter1, _security_cookie, BugCheckParameter3, 0i64);
  v1 = __ROL8__(BugCheckParameter1, 16);
  if ( (_WORD)v1 )
  {
    BugCheckParameter1 = __ROR8__(v1, 16);
    goto LABEL_4;
  }
}

//----- (0000000140004B98) ----------------------------------------------------
signed __int64 __fastcall sub_140004B98(__int64 a1, unsigned __int64 a2, __int64 a3, __int64 a4)
{
  sub_140004BB8(a2, a4, *(_QWORD *)(a4 + 56));
  return 1i64;
}

//----- (0000000140004BB8) ----------------------------------------------------
void __fastcall sub_140004BB8(unsigned __int64 a1, __int64 a2, __int64 a3)
{
  unsigned __int64 v3; // r9@1
  unsigned __int64 v4; // r10@1
  __int64 v5; // rcx@3
  __int64 v6; // rax@3

  v3 = a1;
  v4 = a1;
  if ( *(_DWORD *)a3 & 4 )
    v4 = -*(_DWORD *)(a3 + 8) & (a1 + *(_DWORD *)(a3 + 4));
  v5 = *(_DWORD *)(*(_QWORD *)(a2 + 16) + 8i64);
  v6 = *(_QWORD *)(a2 + 8);
  if ( *(_BYTE *)(v5 + v6 + 3) & 0xF )
    v3 += (unsigned __int8)(*(_BYTE *)(v5 + v6 + 3) & 0xF0);
  sub_140004B50(*(_QWORD *)((signed int)(*(_DWORD *)a3 & 0xFFFFFFF8) + v4) ^ v3);
}

//----- (0000000140004C80) ----------------------------------------------------
int __fastcall sub_140004C80(signed __int64 *a1, signed __int64 a2, unsigned __int64 a3)
{
  signed __int64 *v3; // rax@1
  unsigned __int64 v4; // r9@3
  unsigned __int64 i; // r8@5
  int v6; // ecx@8
  char *v7; // rcx@10
  unsigned __int64 v8; // r10@10
  unsigned __int64 j; // r8@13

  v3 = a1;
  if ( a3 < 8 )
  {
LABEL_5:
    for ( i = a3 & 7; i; --i )
      *((_BYTE *)a1 + i - 1) = a2;
    return (unsigned __int64)v3;
  }
  a2 = 72340172838076673i64 * (unsigned __int8)a2;
  if ( a3 < 0x47 )
  {
    v4 = a3 & 0xFFFFFFFFFFFFFFF8ui64;
    a1 = (signed __int64 *)((char *)a1 + (a3 & 0xFFFFFFFFFFFFFFF8ui64));
    do
    {
      *(signed __int64 *)((char *)v3 + v4 - 8) = a2;
      v4 -= 8i64;
    }
    while ( v4 );
    goto LABEL_5;
  }
  v6 = -(signed int)a1 & 7;
  if ( v6 )
  {
    a3 -= (unsigned int)v6;
    *v3 = a2;
  }
  v7 = (char *)v3 + (unsigned int)v6;
  v8 = a3 >> 6;
  if ( (a3 >> 3) & 7 )
  {
    LODWORD(v3) = ((int (__fastcall *)(char *, signed __int64))((char *)&loc_140004D3D + -4 * (((a3 >> 3) & 7) - 8) + 2))(
                    &v7[8 * (((a3 >> 3) & 7) - 8)],
                    a2);
  }
  else
  {
    do
    {
      *(_QWORD *)v7 = a2;
      *((_QWORD *)v7 + 1) = a2;
      *((_QWORD *)v7 + 2) = a2;
      *((_QWORD *)v7 + 3) = a2;
      *((_QWORD *)v7 + 4) = a2;
      *((_QWORD *)v7 + 5) = a2;
      *((_QWORD *)v7 + 6) = a2;
      *((_QWORD *)v7 + 7) = a2;
      v7 += 64;
      --v8;
    }
    while ( v8 );
    for ( j = a3 & 7; j; --j )
      v7[j - 1] = a2;
  }
  return (unsigned __int64)v3;
}

//----- (0000000140004D80) ----------------------------------------------------
__m128i *__fastcall sub_140004D80(char *_RCX, unsigned __int64 a2, unsigned __int64 a3)
{
  __m128i *v3; // r11@1
  bool v4; // cf@1
  unsigned __int64 k; // r9@3
  __int64 v7; // rax@4
  unsigned __int64 l; // r8@5
  char v9; // al@6
  __m128i *result; // rax@7
  int v11; // ecx@9
  unsigned __int64 v12; // r9@12
  __m128i v13; // xmm0@14
  __m128i v14; // xmm1@14
  signed int v15; // eax@20
  signed int v16; // eax@22
  __m128i v17; // xmm1@23
  __m128i v18; // xmm1@23
  unsigned __int64 i; // r9@28
  __int64 v21; // rax@29
  unsigned __int64 j; // r8@30
  char v23; // al@31
  signed __int64 v24; // rax@34
  signed __int64 v25; // rcx@34
  unsigned __int64 v26; // r9@37
  __m128i v27; // xmm0@39
  __m128i v28; // xmm1@39
  signed int v29; // eax@45
  signed int v30; // eax@47
  __m128i v31; // xmm1@48
  __m128i v32; // xmm1@48
  void *retaddr; // [sp+0h] [bp+0h]@25

  v3 = (__m128i *)_RCX;
  v4 = a2 < (unsigned __int64)_RCX;
  _RDX = a2 - (_QWORD)_RCX;
  if ( v4 )
  {
    _RCX = (signed __int64)&_RCX[a3];
    if ( a3 >= 0x4F )
    {
      if ( _RDX > 0xFFFFFFFFFFFFFFF0ui64 )
      {
        for ( ; _RCX & 0xF; *(_BYTE *)_RCX = *(_BYTE *)(_RDX + _RCX) )
        {
          --_RCX;
          --a3;
        }
      }
      else
      {
        v24 = _RCX;
        v25 = _RCX & 0xF;
        if ( (_DWORD)v25 )
        {
          a3 -= (unsigned int)v25;
          v25 = -(signed __int64)(unsigned int)v25;
          _mm_storeu_si128((__m128i *)(v24 - 16), _mm_loadu_si128((const __m128i *)(_RDX + v24 - 16)));
        }
        _RCX = v24 + v25;
      }
      v26 = a3 >> 5;
      if ( a3 >> 5 <= 0x2000 || _RDX > 0xFFFFFFFFFFFFFE00ui64 )
        goto LABEL_54;
      do
      {
        v29 = 4;
        do
        {
          _RCX -= 128i64;
          __asm
          {
            prefetchnta byte ptr [rdx+rcx]
            prefetchnta byte ptr [rdx+rcx+40h]
          }
          --v29;
        }
        while ( v29 );
        _RCX += 512i64;
        v30 = 8;
        do
        {
          v31 = _mm_loadu_si128((const __m128i *)(_RDX + _RCX - 32));
          _mm_stream_si128((__m128i *)(_RCX - 16), _mm_loadu_si128((const __m128i *)(_RDX + _RCX - 16)));
          _mm_stream_si128((__m128i *)(_RCX - 32), v31);
          _RCX -= 64i64;
          v32 = _mm_loadu_si128((const __m128i *)(_RDX + _RCX));
          _mm_stream_si128((__m128i *)(_RCX + 16), _mm_loadu_si128((const __m128i *)(_RDX + _RCX + 16)));
          _mm_stream_si128((__m128i *)_RCX, v32);
          --v30;
        }
        while ( v30 );
        a3 -= 512i64;
      }
      while ( a3 >= 0x200 );
      _InterlockedOr8((volatile signed __int8 *)&retaddr, 0);
      v26 = a3 >> 5;
      if ( a3 >> 5 )
      {
LABEL_54:
        a3 &= 0x1Fu;
        do
        {
          v27 = _mm_loadu_si128((const __m128i *)(_RDX + _RCX - 16));
          v28 = _mm_loadu_si128((const __m128i *)(_RDX + _RCX - 32));
          _RCX -= 32i64;
          _mm_store_si128((__m128i *)(_RCX + 16), v27);
          _mm_store_si128((__m128i *)_RCX, v28);
          --v26;
        }
        while ( v26 );
      }
    }
    for ( i = a3 >> 3; i; *(_QWORD *)_RCX = v21 )
    {
      v21 = *(_QWORD *)(_RDX + _RCX - 8);
      _RCX -= 8i64;
      --i;
    }
    for ( j = a3 & 7; j; *(_BYTE *)_RCX = v23 )
    {
      v23 = *(_BYTE *)(_RDX + _RCX-- - 1);
      --j;
    }
    result = v3;
  }
  else
  {
    if ( a3 >= 0x4F )
    {
      if ( _RDX < 0x10 )
      {
        for ( ; (unsigned __int8)_RCX & 0xF; ++_RCX )
        {
          --a3;
          *_RCX = _RCX[_RDX];
        }
      }
      else
      {
        v11 = -(signed int)_RCX & 0xF;
        if ( v11 )
        {
          a3 -= (unsigned int)v11;
          _mm_storeu_si128(v3, _mm_loadu_si128((__m128i *)((char *)v3 + _RDX)));
        }
        _RCX = (char *)v3->m128i_i64 + (unsigned int)v11;
      }
      v12 = a3 >> 5;
      if ( a3 >> 5 <= 0x2000 || _RDX < 0x200 )
        goto LABEL_55;
      do
      {
        v15 = 4;
        do
        {
          __asm
          {
            prefetchnta byte ptr [rdx+rcx]
            prefetchnta byte ptr [rdx+rcx+40h]
          }
          _RCX += 128;
          --v15;
        }
        while ( v15 );
        _RCX -= 512;
        v16 = 8;
        do
        {
          v17 = _mm_loadu_si128((const __m128i *)&_RCX[_RDX + 16]);
          _mm_stream_si128((__m128i *)_RCX, _mm_loadu_si128((const __m128i *)&_RCX[_RDX]));
          _mm_stream_si128((__m128i *)_RCX + 1, v17);
          _RCX += 64;
          v18 = _mm_loadu_si128((const __m128i *)&_RCX[_RDX - 16]);
          _mm_stream_si128((__m128i *)_RCX - 2, _mm_loadu_si128((const __m128i *)&_RCX[_RDX - 32]));
          _mm_stream_si128((__m128i *)_RCX - 1, v18);
          --v16;
        }
        while ( v16 );
        a3 -= 512i64;
      }
      while ( a3 >= 0x200 );
      _InterlockedOr8((volatile signed __int8 *)&retaddr, 0);
      v12 = a3 >> 5;
      if ( a3 >> 5 )
      {
LABEL_55:
        a3 &= 0x1Fu;
        do
        {
          v13 = _mm_loadu_si128((const __m128i *)&_RCX[_RDX]);
          v14 = _mm_loadu_si128((const __m128i *)&_RCX[_RDX + 16]);
          _RCX += 32;
          _mm_store_si128((__m128i *)_RCX - 2, v13);
          _mm_store_si128((__m128i *)_RCX - 1, v14);
          --v12;
        }
        while ( v12 );
      }
    }
    for ( k = a3 >> 3; k; *((_QWORD *)_RCX - 1) = v7 )
    {
      v7 = *(_QWORD *)&_RCX[_RDX];
      _RCX += 8;
      --k;
    }
    for ( l = a3 & 7; l; *(_RCX - 1) = v9 )
    {
      v9 = (_RCX++)[_RDX];
      --l;
    }
    result = v3;
  }
  return result;
}

//----- (00000001400050C6) ----------------------------------------------------
unsigned __int64 __fastcall sub_1400050C6(__int64 a1, __int64 a2)
{
  unsigned __int64 result; // rax@1

  result = *(_QWORD *)(a2 + 56);
  __writecr3(result);
  return result;
}

//----- (00000001400050DD) ----------------------------------------------------
void sub_1400050DD()
{
  ;
}

//----- (00000001400050ED) ----------------------------------------------------
void sub_1400050ED()
{
  ;
}

//----- (000000014000B000) ----------------------------------------------------
void sub_14000B000()
{
  void *v0; // rcx@5
  void *v1; // rcx@7
  void *v2; // rcx@9

  dword_1400072E0 = 0;
  if ( *((_QWORD *)&unk_1400070A0 + 21) )
  {
    *((_BYTE *)&unk_1400070A0 + 161) = 0;
    if ( ZwWaitForSingleObject(*((_QWORD *)&unk_1400070A0 + 21), 0i64, 0i64) < 0 )
      sub_140001588();
    ZwClose(*((HANDLE *)&unk_1400070A0 + 21));
    *((_QWORD *)&unk_1400070A0 + 21) = 0i64;
  }
  v0 = (void *)*((_QWORD *)&unk_1400070A0 + 5);
  if ( v0 )
  {
    ZwClose(v0);
    *((_QWORD *)&unk_1400070A0 + 5) = 0i64;
  }
  v1 = (void *)*((_QWORD *)&unk_1400070A0 + 3);
  if ( v1 )
  {
    ExFreePoolWithTag(v1, 0x20676F6Cu);
    *((_QWORD *)&unk_1400070A0 + 3) = 0i64;
  }
  v2 = (void *)*((_QWORD *)&unk_1400070A0 + 2);
  if ( v2 )
  {
    ExFreePoolWithTag(v2, 0x20676F6Cu);
    *((_QWORD *)&unk_1400070A0 + 2) = 0i64;
  }
  if ( *((_BYTE *)&unk_1400070A0 + 160) )
  {
    ExDeleteResourceLite((PERESOURCE)((char *)&unk_1400070A0 + 56));
    *((_BYTE *)&unk_1400070A0 + 160) = 0;
  }
}
// 140006058: using guessed type int __fastcall ZwWaitForSingleObject(_QWORD, _QWORD, _QWORD);
// 1400072E0: using guessed type int dword_1400072E0;

//----- (000000014000B0C4) ----------------------------------------------------
void sub_14000B0C4()
{
  sub_14000B81C();
  sub_14000B71C();
  sub_14000B5EC();
}

//----- (000000014000B0DC) ----------------------------------------------------
signed __int64 *sub_14000B0DC()
{
  signed __int64 *v0; // rax@1
  signed __int64 *v1; // rbx@1
  signed __int64 *v2; // rax@2
  signed __int64 *v3; // rdi@2
  signed __int64 *v4; // rax@3
  signed __int64 *v5; // rsi@3
  unsigned __int64 v6; // rax@4
  unsigned __int64 v7; // rax@4
  unsigned int v8; // er15@4
  _DWORD *v9; // r12@4
  __int64 v10; // rbp@5
  __int64 v11; // r13@5
  unsigned __int64 v12; // rax@9
  signed __int64 *v13; // rax@10
  signed __int64 *v14; // rbp@10
  unsigned int v15; // er14@11
  signed __int64 **v16; // r15@11
  signed __int64 *v17; // rax@12
  signed __int64 *result; // rax@14
  ULONG v19; // edx@15

  v0 = (signed __int64 *)ExAllocatePoolWithTag(0, 0x20ui64, 0x56484C46u);
  v1 = v0;
  if ( !v0 )
    return 0i64;
  sub_140004C80(v0, 0i64, 0x20ui64);
  v2 = (signed __int64 *)ExAllocatePoolWithTag(0, 0x1000ui64, 0x56484C46u);
  v3 = v2;
  if ( v2 )
  {
    sub_140004C80(v2, 0i64, 0x1000ui64);
    v4 = (signed __int64 *)ExAllocatePoolWithTag(0, 0x1000ui64, 0x56484C46u);
    v5 = v4;
    if ( v4 )
    {
      sub_140004C80(v4, 0i64, 0x1000ui64);
      LODWORD(v6) = MmGetPhysicalAddress(v5);
      *v3 = *v3 & 0xFFFFFFFFFFFFFFD8ui64 | sub_140002BBC(v6) & 7 | 0x18;
      LODWORD(v7) = MmGetPhysicalAddress(v5);
      *v3 ^= (*v3 ^ (sub_140002F78(v7) << 12)) & 0xFFFFFFFFF000i64;
      v8 = 0;
      v9 = sub_140002D28();
      if ( *v9 )
      {
        while ( 1 )
        {
          v10 = 0i64;
          v11 = *(_QWORD *)&v9[4 * (v8 + 1i64)];
          if ( *(_QWORD *)&v9[4 * (v8 + 1i64) + 2] )
            break;
LABEL_8:
          if ( ++v8 >= *v9 )
            goto LABEL_9;
        }
        while ( sub_140002870((__int64)v5, 4, (v11 + v10) << 12, 0i64) )
        {
          if ( (unsigned __int64)++v10 >= *(_QWORD *)&v9[4 * (v8 + 1i64) + 2] )
            goto LABEL_8;
        }
        sub_1400029E4(v5, 4);
        ExFreePoolWithTag(v3, 0x56484C46u);
        v19 = 1447578694;
        goto LABEL_20;
      }
LABEL_9:
      v12 = sub_140002F80(0x1Bu);
      if ( sub_140002870((__int64)v5, 4, ((v12 >> 12) & 0xFFFFFF) << 12, 0i64) )
      {
        v13 = (signed __int64 *)ExAllocatePoolWithTag(0, 0x190ui64, 0x56484C46u);
        v14 = v13;
        if ( v13 )
        {
          sub_140004C80(v13, 0i64, 0x190ui64);
          v15 = 0;
          v16 = (signed __int64 **)v14;
          while ( 1 )
          {
            v17 = sub_14000280C(0i64);
            if ( !v17 )
              break;
            *v16 = v17;
            ++v15;
            ++v16;
            if ( v15 >= 0x32 )
            {
              *v1 = (signed __int64)v3;
              result = v1;
              v1[1] = (signed __int64)v5;
              v1[2] = (signed __int64)v14;
              *((_DWORD *)v1 + 6) = 0;
              return result;
            }
          }
          sub_140002A84(v14, 0);
        }
      }
      sub_1400029E4(v5, 4);
    }
    ExFreePoolWithTag(v3, 0x56484C46u);
  }
  v19 = 1447578694;
LABEL_20:
  ExFreePoolWithTag(v1, v19);
  return 0i64;
}
// 140002F70: using guessed type int __fastcall MmGetPhysicalAddress(_QWORD);

//----- (000000014000B330) ----------------------------------------------------
void sub_14000B330()
{
  int v0; // esi@1
  unsigned __int64 v1; // rbx@1
  unsigned __int64 v2; // rax@1
  unsigned __int8 v3; // di@1
  __int64 v4; // rbp@3
  void *v5; // rdx@3
  __int64 v6; // rbx@3
  __int64 v7; // r8@3
  __int64 v8; // rcx@4
  __int64 v9; // r15@5
  __int64 v10; // r14@5
  unsigned int v11; // ebp@5
  __int64 v12; // r8@6
  char *v13; // rdx@6
  signed __int64 v14; // rcx@7
  __int64 v15; // rbp@9
  __int64 v16; // r14@9
  char *v17; // rdx@10
  __int64 *v18; // r8@10
  int v19; // ebp@13
  unsigned __int64 v20; // r14@13
  unsigned int v21; // edi@14
  char *v22; // rsi@14
  unsigned __int64 v23; // rax@15
  unsigned __int64 v24; // rax@16
  signed __int64 v25; // rdx@16
  __int64 v26; // [sp+0h] [bp-48h]@18
  unsigned __int64 v27; // [sp+20h] [bp-28h]@3
  __int64 v28; // [sp+28h] [bp-20h]@3

  v0 = 0;
  v1 = sub_140002F80(0x2FFu);
  byte_140008C20 = v1;
  v2 = sub_140002F80(0xFEu);
  v3 = v2;
  if ( _bittest64((const signed __int64 *)&v2, 8u) && _bittest64((const signed __int64 *)&v1, 0xAu) )
  {
    v4 = 0i64;
    v27 = sub_140002F80(0x250u);
    v5 = &unk_140007331;
    v6 = &v28 >= (__int64 *)&v27 ? 8 : 0;
    v7 = 0i64;
    do
    {
      v8 = v4;
      *((_BYTE *)v5 + 1) = *((_BYTE *)&v27 + v7);
      v4 += 0x10000i64;
      *(_WORD *)((char *)v5 - 1) = 257;
      ++v0;
      *(_QWORD *)((char *)v5 + 7) = v8;
      v5 = (char *)v5 + 24;
      ++v7;
      *(_QWORD *)((char *)v5 - 9) = v8 + 0xFFFF;
    }
    while ( v7 != v6 );
    v9 = 0i64;
    v10 = v0;
    v11 = 600;
    do
    {
      v27 = sub_140002F80(v11);
      v12 = 0i64;
      v13 = (char *)&unk_140007330 + 24 * v10 + 1;
      do
      {
        v14 = v9 + 0x80000;
        v13[1] = *((_BYTE *)&v27 + v12);
        *(_QWORD *)(v13 + 15) = v9 + 540671;
        v9 += 0x4000i64;
        *(_WORD *)(v13 - 1) = 257;
        ++v0;
        *(_QWORD *)(v13 + 7) = v14;
        v13 += 24;
        ++v10;
        ++v12;
      }
      while ( v12 != v6 );
      ++v11;
    }
    while ( v11 <= 0x259 );
    v15 = 0i64;
    v16 = v0;
    LODWORD(v1) = 616;
    do
    {
      v27 = sub_140002F80(v1);
      v17 = (char *)&unk_140007330 + 24 * v16 + 1;
      v18 = (__int64 *)&v27;
      do
      {
        v17[1] = *(_BYTE *)v18;
        *(_QWORD *)(v17 + 15) = v15 + 790527;
        v18 = (__int64 *)((char *)v18 + 1);
        *(_QWORD *)(v17 + 7) = v15 + 786432;
        *(_WORD *)(v17 - 1) = 257;
        v17 += 24;
        v15 += 4096i64;
        ++v0;
        ++v16;
      }
      while ( (char *)v18 - (char *)&v27 != 8 );
      v1 = (unsigned int)(v1 + 1);
    }
    while ( (unsigned int)v1 <= 0x26F );
  }
  v19 = 0;
  v20 = v3;
  if ( v3 )
  {
    v21 = 512;
    v22 = (char *)&unk_140007330 + 24 * v0 + 1;
    do
    {
      v23 = sub_140002F80(v21 + 1);
      if ( _bittest64((const signed __int64 *)&v23, 0xBu) )
      {
        _BitScanForward64(&v1, ((v23 >> 12) & 0xFFFFFFFFFi64) << 12);
        v24 = sub_140002F80(v21);
        v22[1] = v24;
        *(_WORD *)(v22 - 1) = 1;
        v25 = ((v24 >> 12) & 0xFFFFFFFFFi64) << 12;
        *(_QWORD *)(v22 + 7) = v25;
        *(_QWORD *)(v22 + 15) = v25 + (1i64 << v1) - 1;
        v22 += 24;
      }
      ++v19;
      v21 += 2;
    }
    while ( v19 < v20 );
  }
  sub_140004B50((unsigned __int64)&v26 ^ v28);
}
// 140008C20: using guessed type char byte_140008C20;

//----- (000000014000B5A4) ----------------------------------------------------
bool sub_14000B5A4()
{
  unsigned __int64 v0; // rax@1
  unsigned __int64 v1; // rax@2
  bool result; // al@7

  v0 = sub_140002F80(0x48Cu);
  result = 0;
  if ( (v0 & 0x6104040) == 101728320 )
  {
    v1 = v0 >> 32;
    if ( v1 & 1 )
    {
      if ( _bittest((const signed int *)&v1, 8u)
        && _bittest((const signed int *)&v1, 9u)
        && _bittest((const signed int *)&v1, 0xAu)
        && _bittest((const signed int *)&v1, 0xBu) )
      {
        result = 1;
      }
    }
  }
  return result;
}

//----- (000000014000B5EC) ----------------------------------------------------
void sub_14000B5EC()
{
  __int64 v0; // rcx@1
  void *v1; // rbx@2

  while ( 1 )
  {
    v0 = qword_140008C28;
    if ( !qword_140008C28 )
      break;
    v1 = (void *)(qword_140008C28 - 8);
    qword_140008C28 = *(_QWORD *)qword_140008C28;
    (*(void (**)(void))(v0 - 8))();
    ExFreePoolWithTag(v1, 0x6A624F47u);
  }
}
// 140008C28: using guessed type __int64 qword_140008C28;

//----- (000000014000B624) ----------------------------------------------------
void __fastcall sub_14000B624(int (__fastcall *a1)(__int64), __int64 a2)
{
  int (__fastcall *v2)(__int64); // r14@1
  __int64 v3; // r15@1
  unsigned int v4; // ebx@1
  int v5; // edi@1
  int v6; // esi@3
  __int64 v7; // [sp+0h] [bp-50h]@5
  int v8; // [sp+20h] [bp-30h]@2
  __int64 v9; // [sp+28h] [bp-28h]@3
  __int64 v10; // [sp+30h] [bp-20h]@3
  __int64 v11; // [sp+38h] [bp-18h]@3
  __int64 v12; // [sp+40h] [bp-10h]@3
  __int64 v13; // [sp+48h] [bp-8h]@5

  v2 = a1;
  v3 = a2;
  v4 = 0;
  v5 = KeQueryActiveProcessorCountEx(0xFFFFi64);
  if ( v5 )
  {
    do
    {
      v8 = 0;
      if ( KeGetProcessorNumberFromIndex(v4, &v8) < 0 )
        break;
      v10 = 0i64;
      LOWORD(v10) = v8;
      v9 = 1i64 << SBYTE2(v8);
      v11 = 0i64;
      v12 = 0i64;
      KeSetSystemGroupAffinityThread(&v9, &v11);
      v6 = v2(v3);
      KeRevertToUserGroupAffinityThread(&v11);
      if ( v6 < 0 )
        break;
      ++v4;
    }
    while ( v4 < v5 );
  }
  sub_140004B50((unsigned __int64)&v7 ^ v13);
}
// 140004C26: using guessed type int __fastcall KeGetProcessorNumberFromIndex(_QWORD, _QWORD);
// 140006080: using guessed type int __fastcall KeSetSystemGroupAffinityThread(_QWORD, _QWORD);
// 140006088: using guessed type int __fastcall KeRevertToUserGroupAffinityThread(_QWORD);
// 140006090: using guessed type int __fastcall KeQueryActiveProcessorCountEx(_QWORD);

//----- (000000014000B6EC) ----------------------------------------------------
PVOID __fastcall sub_14000B6EC(PCWSTR SourceString)
{
  UNICODE_STRING DestinationString; // [sp+20h] [bp-18h]@1

  *(_QWORD *)&DestinationString.Length = 0i64;
  DestinationString.Buffer = 0i64;
  RtlInitUnicodeString(&DestinationString, SourceString);
  return MmGetSystemRoutineAddress(&DestinationString);
}

//----- (000000014000B71C) ----------------------------------------------------
void sub_14000B71C()
{
  if ( P )
    ExFreePoolWithTag(P, 0x56484C46u);
}

//----- (000000014000B73C) ----------------------------------------------------
void sub_14000B73C()
{
  char v15; // bl@5
  int v16; // eax@6
  signed __int64 *v17; // rbx@9
  int v18; // eax@10

  _RAX = 1i64;
  __asm { cpuid }
  if ( (signed int)_RCX >= 0 )
    goto LABEL_14;
  _RAX = 1073741825i64;
  __asm { cpuid }
  if ( (_DWORD)_RAX != 1447578694 )
  {
LABEL_14:
    _RAX = 1i64;
    __asm { cpuid }
    if ( _RCX & 0x20 )
    {
      if ( (((unsigned int)(sub_140002F80(0x480u) >> 32) >> 18) & 0xF) == 6 )
      {
        v15 = sub_140002F80(0x3Au);
        if ( v15 & 1 || (sub_14000B624((int (__fastcall *)(__int64))sub_14000BDE0, 0i64), v16 >= 0) )
        {
          if ( v15 & 4 )
          {
            if ( sub_14000B5A4() )
            {
              v17 = sub_14000BAC4();
              if ( v17 )
              {
                sub_14000B330();
                sub_14000B624((int (__fastcall *)(__int64))sub_14000C614, (__int64)v17);
                if ( v18 < 0 )
                  sub_14000B624((int (__fastcall *)(__int64))sub_14000C638, 0i64);
              }
            }
          }
        }
      }
    }
  }
}

//----- (000000014000B81C) ----------------------------------------------------
void sub_14000B81C()
{
  sub_14000B624((int (__fastcall *)(__int64))sub_14000C638, 0i64);
}

//----- (000000014000B82C) ----------------------------------------------------
signed __int64 *sub_14000B82C()
{
  signed __int64 *result; // rax@1
  signed __int64 *v1; // rdi@1
  unsigned int v2; // ebx@1
  RTL_BITMAP BitMapHeader; // [sp+20h] [bp-38h]@2
  RTL_BITMAP v4; // [sp+30h] [bp-28h]@5

  result = (signed __int64 *)ExAllocatePoolWithTag(0, 0x1000ui64, 0x56484C46u);
  v1 = result;
  v2 = 0;
  if ( result )
  {
    sub_140004C80(result, 0i64, 0x1000ui64);
    sub_140004C80(v1, 255i64, 0x400ui64);
    sub_140004C80(v1 + 128, 255i64, 0x400ui64);
    *(_QWORD *)&BitMapHeader.SizeOfBitMap = 0i64;
    BitMapHeader.Buffer = 0i64;
    RtlInitializeBitMap(&BitMapHeader, (PULONG)v1, 0x2000u);
    RtlClearBits(&BitMapHeader, 0xE7u, 2u);
    while ( v2 < 0x1000 )
      sub_140002F80(v2++);
    *(_QWORD *)&v4.SizeOfBitMap = 0i64;
    v4.Buffer = 0i64;
    RtlInitializeBitMap(&v4, (PULONG)v1 + 256, 0x2000u);
    RtlClearBits(&v4, 0x101u, 2u);
    result = v1;
  }
  return result;
}

//----- (000000014000B950) ----------------------------------------------------
void __fastcall sub_14000B950(PVOID P)
{
  PVOID *v1; // rbx@2
  void *v2; // rcx@4
  void *v3; // rcx@6
  __int64 v4; // rcx@8
  void *v5; // rcx@12
  void *v6; // rcx@14

  if ( P )
  {
    v1 = (PVOID *)P;
    if ( *((_QWORD *)P + 1) )
      MmFreeContiguousMemory();
    v2 = v1[3];
    if ( v2 )
      ExFreePoolWithTag(v2, 0x56484C46u);
    v3 = v1[2];
    if ( v3 )
      ExFreePoolWithTag(v3, 0x56484C46u);
    v4 = (__int64)v1[4];
    if ( v4 )
      sub_1400027C4(v4);
    if ( *v1 && _InterlockedExchangeAdd((volatile signed __int32 *)*v1, 0xFFFFFFFF) == 1 )
    {
      v5 = (void *)*((_QWORD *)*v1 + 2);
      if ( v5 )
        ExFreePoolWithTag(v5, 0x56484C46u);
      v6 = (void *)*((_QWORD *)*v1 + 1);
      if ( v6 )
        ExFreePoolWithTag(v6, 0x56484C46u);
      ExFreePoolWithTag(*v1, 0x56484C46u);
    }
    ExFreePoolWithTag(v1, 0x56484C46u);
  }
}
// 140002D20: using guessed type int MmFreeContiguousMemory(void);

//----- (000000014000BA08) ----------------------------------------------------
int __fastcall sub_14000BA08(unsigned __int16 a1)
{
  unsigned __int64 v1; // rax@2
  signed __int64 v2; // rax@2

  if ( a1 )
  {
    LODWORD(v1) = ((int (__fastcall *)(_QWORD))word_14000152E)(a1);
    v2 = (v1 >> 8) & 0xF0FF;
  }
  else
  {
    LODWORD(v2) = 0x10000;
  }
  return v2;
}
// 14000152E: using guessed type __int16 word_14000152E;

//----- (000000014000BA30) ----------------------------------------------------
unsigned __int64 __fastcall sub_14000BA30(__int64 a1, unsigned __int16 a2)
{
  unsigned __int16 v2; // bx@1
  __int64 v3; // rdi@1
  unsigned __int64 result; // rax@2
  __int16 v5; // ax@4
  __int64 v6; // rcx@4

  v2 = a2;
  v3 = a1;
  if ( a2 )
  {
    if ( a2 & 4 )
    {
      v5 = sub_1400014F0();
      v6 = sub_14000BA8C(v3 + 8 * ((unsigned __int64)(unsigned __int16)v5 >> 3)) + 8 * ((unsigned __int64)v2 >> 3);
    }
    else
    {
      v6 = a1 + 8 * ((unsigned __int64)a2 >> 3);
    }
    result = sub_14000BA8C(v6);
  }
  else
  {
    result = 0i64;
  }
  return result;
}

//----- (000000014000BA8C) ----------------------------------------------------
unsigned __int64 __fastcall sub_14000BA8C(__int64 a1)
{
  unsigned __int64 v1; // r8@1

  v1 = *(_WORD *)(a1 + 2) | ((*(_BYTE *)(a1 + 4) | ((unsigned __int64)*(_BYTE *)(a1 + 7) << 8)) << 16);
  if ( !(*(_QWORD *)a1 & 0x100000000000i64) )
    v1 |= (unsigned __int64)*(_DWORD *)(a1 + 8) << 32;
  return v1;
}

//----- (000000014000BAC4) ----------------------------------------------------
signed __int64 *sub_14000BAC4()
{
  signed __int64 *v0; // rax@1
  signed __int64 *v1; // rdi@1
  signed __int64 *v2; // rax@2
  signed __int64 *v3; // rax@3
  ULONG *v4; // rsi@3
  signed __int64 *v5; // rbx@4
  signed __int64 *result; // rax@4
  RTL_BITMAP BitMapHeader; // [sp+20h] [bp-28h]@4
  RTL_BITMAP v8; // [sp+30h] [bp-18h]@4

  v0 = (signed __int64 *)ExAllocatePoolWithTag(0, 0x20ui64, 0x56484C46u);
  v1 = v0;
  if ( v0 )
  {
    sub_140004C80(v0, 0i64, 0x20ui64);
    v2 = sub_14000B82C();
    v1[1] = (signed __int64)v2;
    if ( v2 )
    {
      v3 = (signed __int64 *)ExAllocatePoolWithTag(0, 0x2000ui64, 0x56484C46u);
      v4 = (ULONG *)v3;
      if ( v3 )
      {
        v5 = v3 + 512;
        sub_140004C80(v3, 0i64, 0x1000ui64);
        sub_140004C80(v5, 0i64, 0x1000ui64);
        *(_QWORD *)&BitMapHeader.SizeOfBitMap = 0i64;
        BitMapHeader.Buffer = 0i64;
        RtlInitializeBitMap(&BitMapHeader, v4, 0x8000u);
        *(_QWORD *)&v8.SizeOfBitMap = 0i64;
        v8.Buffer = 0i64;
        RtlInitializeBitMap(&v8, (PULONG)v5, 0x8000u);
        result = v1;
        v1[2] = (signed __int64)v4;
        v1[3] = (signed __int64)v5;
        return result;
      }
      ExFreePoolWithTag((PVOID)v1[1], 0x56484C46u);
    }
    ExFreePoolWithTag(v1, 0x56484C46u);
  }
  return 0i64;
}

//----- (000000014000BBCC) ----------------------------------------------------
void __fastcall sub_14000BBCC(__int64 a1, __int64 a2, volatile signed __int32 *a3)
{
  volatile signed __int32 *v3; // rbx@2
  __int64 v4; // rsi@2
  __int64 v5; // rbp@2
  signed __int64 *v6; // rax@2
  __int64 v7; // rdi@2
  signed __int64 *v8; // rax@3
  signed __int64 *v9; // rax@4
  signed __int64 *v10; // rax@5
  signed __int64 *v11; // rax@6
  __int64 v12; // rax@7
  __int64 v13; // r14@7
  unsigned __int64 v14; // rbx@7
  unsigned __int64 v15; // rbx@7
  __int64 v16; // rax@7
  unsigned __int8 v17; // cf@8
  unsigned __int8 v18; // zf@8
  char v19; // al@10
  __int64 v21; // [sp+20h] [bp+20h]@7

  if ( a3 )
  {
    v3 = a3;
    v4 = a2;
    v5 = a1;
    v6 = (signed __int64 *)ExAllocatePoolWithTag(0, 0x28ui64, 0x56484C46u);
    v7 = (__int64)v6;
    if ( v6 )
    {
      sub_140004C80(v6, 0i64, 0x28ui64);
      *(_QWORD *)v7 = v3;
      _InterlockedIncrement(v3);
      v8 = sub_14000B0DC();
      *(_QWORD *)(v7 + 32) = v8;
      if ( v8 )
      {
        LODWORD(v9) = sub_140002CDC(24576i64);
        *(_QWORD *)(v7 + 8) = v9;
        if ( v9 )
        {
          sub_140004C80(v9, 0i64, 0x6000ui64);
          v10 = (signed __int64 *)ExAllocatePoolWithTag(0, 0x1000ui64, 0x56484C46u);
          *(_QWORD *)(v7 + 24) = v10;
          if ( v10 )
          {
            sub_140004C80(v10, 0i64, 0x1000ui64);
            v11 = (signed __int64 *)ExAllocatePoolWithTag(0, 0x1000ui64, 0x56484C46u);
            *(_QWORD *)(v7 + 16) = v11;
            if ( v11 )
            {
              sub_140004C80(v11, 0i64, 0x1000ui64);
              v12 = *(_QWORD *)(v7 + 8);
              v13 = v12 + 24560;
              *(_QWORD *)(v12 + 24560) = -1i64;
              *(_QWORD *)(v12 + 24568) = v7;
              v14 = sub_140002F80(0x486u);
              __writecr0(v14 | sub_140002F80(0x487u) & __readcr0());
              v15 = sub_140002F80(0x488u);
              __writecr4(v15 | sub_140002F80(0x489u) & __readcr4());
              **(_DWORD **)(v7 + 16) = sub_140002F80(0x480u) & 0x7FFFFFFF;
              LODWORD(v16) = MmGetPhysicalAddress(*(_QWORD *)(v7 + 16));
              v21 = v16;
              __asm { vmxon   [rsp+38h+arg_18] }
              if ( !(v17 | v18) )
              {
                sub_140002D30();
                sub_140002D70();
                **(_DWORD **)(v7 + 24) = sub_140002F80(0x480u) & 0x7FFFFFFF;
                MmGetPhysicalAddress(*(_QWORD *)(v7 + 24));
                __asm { vmclear [rsp+38h+arg_10] }
                if ( !(v17 | v18) )
                {
                  __asm { vmptrld [rsp+38h+arg_10] }
                  if ( !(v17 + v17 + v18) )
                  {
                    sub_14000BE30(v7, v5, v4, v13);
                    if ( v19 )
                    {
                      do_vmread(0x4400u);
                      __asm { vmlaunch }
                      if ( v17 + v17 + v18 == 1 )
                        do_vmread(0x4400u);
                      if ( !(_BYTE)KdDebuggerNotPresent )
                        __debugbreak();
                    }
                  }
                }
                __vmx_off();
              }
            }
          }
        }
      }
      sub_14000B950((PVOID)v7);
    }
  }
}
// 140002F70: using guessed type int __fastcall MmGetPhysicalAddress(_QWORD);

//----- (000000014000BDE0) ----------------------------------------------------
__int64 sub_14000BDE0()
{
  unsigned __int64 v0; // rax@1
  __int64 result; // rax@2
  unsigned __int64 v2; // [sp+38h] [bp+10h]@1

  v0 = sub_140002F80(0x3Au);
  v2 = v0;
  if ( v0 & 1 )
  {
    result = 0i64;
  }
  else
  {
    LODWORD(v2) = v0 | 1;
    sub_140002FD8(0x3Au, v2);
    result = (sub_140002F80(0x3Au) & 1) == 0 ? 0xC0000182 : 0;
  }
  return result;
}

//----- (000000014000BE30) ----------------------------------------------------
void __fastcall sub_14000BE30(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  unsigned __int64 v4; // rax@1
  int v5; // edi@1
  unsigned __int64 v6; // rax@1
  unsigned int v7; // er15@1
  unsigned __int64 v8; // rax@1
  unsigned int v9; // er12@1
  unsigned int v10; // er13@1
  unsigned __int64 v11; // rax@1
  unsigned __int64 v12; // rax@1
  __int64 v13; // rbx@1
  __int64 v14; // rsi@1
  __int64 v15; // rdi@1
  __int64 v16; // r14@1
  int v17; // eax@3
  unsigned __int16 v18; // ax@3
  __int16 v19; // ax@3
  __int16 v20; // ax@3
  __int16 v21; // ax@3
  __int16 v22; // ax@3
  unsigned __int16 v23; // ax@3
  __int16 v24; // ax@3
  __int16 v25; // ax@3
  char v26; // al@3
  char v27; // al@3
  char v28; // al@3
  char v29; // al@3
  char v30; // al@3
  char v31; // al@3
  char v32; // al@3
  __int64 v33; // rax@3
  __int64 v34; // rax@3
  __int64 v35; // rax@3
  __int64 v36; // rax@3
  __int64 v37; // rax@3
  char v38; // al@3
  char v39; // cf@3
  bool v40; // zf@3
  unsigned __int16 v41; // ax@5
  __int16 v42; // ax@5
  __int16 v43; // ax@5
  __int16 v44; // ax@5
  __int16 v45; // ax@5
  unsigned __int16 v46; // ax@5
  __int16 v47; // ax@5
  __int16 v48; // ax@5
  unsigned __int16 v49; // ax@5
  int v50; // eax@5
  __int16 v51; // ax@5
  int v52; // eax@5
  __int16 v53; // ax@5
  int v54; // eax@5
  __int16 v55; // ax@5
  int v56; // eax@5
  __int16 v57; // ax@5
  int v58; // eax@5
  unsigned __int16 v59; // ax@5
  int v60; // eax@5
  __int16 v61; // ax@5
  int v62; // eax@5
  __int16 v63; // ax@5
  int v64; // eax@5
  __int64 v65; // rax@5
  __int64 v66; // rax@5
  __int64 v67; // rax@5
  __int64 v68; // rax@5
  __int16 v69; // ax@5
  __int64 v70; // rax@5
  __int16 v71; // ax@5
  __int64 v72; // rax@5
  __int64 v73; // rt0@5
  __int64 v74; // rax@5
  __int64 v75; // rax@5
  __int64 v76; // rax@5
  __int64 v77; // rax@5
  __int16 v78; // ax@5
  __int64 v79; // rax@5
  __int64 v80; // rax@5
  __int64 v81; // rax@5
  __int64 v82; // [sp+20h] [bp+0h]@1
  __int64 v83; // [sp+28h] [bp+8h]@1
  __int64 v84; // [sp+30h] [bp+10h]@1
  __int64 v85; // [sp+38h] [bp+18h]@1
  __int64 v86; // [sp+40h] [bp+20h]@1
  __int64 v87; // [sp+48h] [bp+28h]@1
  __int64 v88; // [sp+50h] [bp+30h]@1
  __int64 v89; // [sp+58h] [bp+38h]@1
  __int64 v90; // [sp+60h] [bp+40h]@1
  __int16 v91; // [sp+68h] [bp+48h]@1
  __int64 v92; // [sp+70h] [bp+50h]@1
  __int16 v93; // [sp+78h] [bp+58h]@1
  __int64 v94; // [sp+80h] [bp+60h]@5

  v82 = a1;
  v90 = 0i64;
  v91 = 0;
  v89 = a4;
  v88 = a3;
  v87 = a2;
  sub_1400014E8(&v90);
  v92 = 0i64;
  v93 = 0;
  __sidt(&v92);
  v4 = sub_140002F80(0x480u);
  v5 = (HIDWORD(v4) >> 23) & 1;
  v6 = sub_140002F80(v5 != 0 ? 1168 : 1156);
  v7 = v6 | HIDWORD(v6) & 0x204;
  v8 = sub_140002F80(v5 != 0 ? 1167 : 1155);
  v9 = v8 | HIDWORD(v8) & 0x8200;
  v10 = sub_140002F80(v5 != 0 ? 1165 : 1153);
  v11 = sub_140002F80(v5 != 0 ? 1166 : 1154);
  v85 = (unsigned int)v11 | HIDWORD(v11) & 0x92808000;
  v12 = sub_140002F80(0x48Bu);
  v13 = 0i64;
  v86 = (unsigned int)v12 | HIDWORD(v12) & 0x10102E;
  v83 = 0i64;
  v14 = __readcr0();
  v15 = 0i64;
  v84 = 0i64;
  v16 = __readcr4();
  if ( sub_140002E38() )
  {
    LODWORD(v83) = v83 | 0xE0000000;
    LODWORD(v84) = v84 | 0x1000B0;
    v15 = v84;
    v13 = v83;
  }
  v17 = KeGetCurrentProcessorNumberEx(0i64);
  do_vmwrite(0, 1, (unsigned int)(v17 + 1));
  v18 = ((int (*)(void))((char *)&loc_140001500 + 2))();
  do_vmwrite(v39, v40, v18);
  v19 = sub_14000150A();
  do_vmwrite(v39, v40, (unsigned __int16)v19);
  v20 = sub_140001512();
  do_vmwrite(v39, v40, (unsigned __int16)v20);
  v21 = sub_14000151A();
  do_vmwrite(v39, v40, (unsigned __int16)v21);
  v22 = sub_140001522();
  do_vmwrite(v39, v40, (unsigned __int16)v22);
  v23 = (*(int (**)(void))&byte_140001528[2])();
  do_vmwrite(v39, v40, v23);
  v24 = sub_1400014F0();
  do_vmwrite(v39, v40, (unsigned __int16)v24);
  v25 = sub_1400014F9();
  do_vmwrite(v39, v40, (unsigned __int16)v25);
  v26 = ((int (*)(void))((char *)&loc_140001500 + 2))();
  do_vmwrite(0, (v26 & 0xF8) == 0, v26 & 0xF8);
  v27 = sub_14000150A();
  do_vmwrite(0, (v27 & 0xF8) == 0, v27 & 0xF8);
  v28 = sub_140001512();
  do_vmwrite(0, (v28 & 0xF8) == 0, v28 & 0xF8);
  v29 = sub_14000151A();
  do_vmwrite(0, (v29 & 0xF8) == 0, v29 & 0xF8);
  v30 = sub_140001522();
  do_vmwrite(0, (v30 & 0xF8) == 0, v30 & 0xF8);
  v31 = (*(int (**)(void))&byte_140001528[2])();
  do_vmwrite(0, (v31 & 0xF8) == 0, v31 & 0xF8);
  v32 = sub_1400014F9();
  do_vmwrite(0, (v32 & 0xF8) == 0, v32 & 0xF8);
  LODWORD(v33) = MmGetPhysicalAddress(*(_QWORD *)(*(_QWORD *)v82 + 16i64));
  do_vmwrite(v39, v40, v33);
  LODWORD(v34) = MmGetPhysicalAddress(*(_QWORD *)(*(_QWORD *)v82 + 24i64));
  do_vmwrite(v39, v40, v34);
  LODWORD(v35) = MmGetPhysicalAddress(*(_QWORD *)(*(_QWORD *)v82 + 8i64));
  do_vmwrite(v39, v40, v35);
  v36 = sub_1400026A8(*(_QWORD *)(v82 + 32));
  do_vmwrite(v39, v40, v36);
  do_vmwrite(0, 0, -1i64);
  v37 = sub_140002F80(0x1D9u);
  do_vmwrite(v39, v40, v37);
  v38 = sub_140002E38();
  v39 = 0;
  v40 = v38 == 0;
  if ( v38 )
    sub_140002E3C(__readcr3());
  do_vmwrite(v39, v40, v10);
  do_vmwrite(v39, v40, (unsigned int)v85);
  do_vmwrite(v39, v40, 2i64);
  do_vmwrite(v39, v40, v9);
  do_vmwrite(v39, v40, v7);
  do_vmwrite(v39, v40, (unsigned int)v86);
  v41 = ((int (*)(void))((char *)&loc_140001500 + 2))();
  do_vmwrite(v39, v40, __segmentlimit(v41));
  v42 = sub_14000150A();
  do_vmwrite(v39, v40, __segmentlimit((unsigned __int16)v42));
  v43 = sub_140001512();
  do_vmwrite(v39, v40, __segmentlimit((unsigned __int16)v43));
  v44 = sub_14000151A();
  do_vmwrite(v39, v40, __segmentlimit((unsigned __int16)v44));
  v45 = sub_140001522();
  do_vmwrite(v39, v40, __segmentlimit((unsigned __int16)v45));
  v46 = (*(int (**)(void))&byte_140001528[2])();
  do_vmwrite(v39, v40, __segmentlimit(v46));
  v47 = sub_1400014F0();
  do_vmwrite(v39, v40, __segmentlimit((unsigned __int16)v47));
  v48 = sub_1400014F9();
  do_vmwrite(v39, v40, __segmentlimit((unsigned __int16)v48));
  do_vmwrite(v39, v40, (unsigned __int16)v90);
  do_vmwrite(v39, v40, (unsigned __int16)v92);
  v49 = ((int (*)(void))((char *)&loc_140001500 + 2))();
  v50 = sub_14000BA08(v49);
  do_vmwrite(v39, v40, (unsigned int)v50);
  v51 = sub_14000150A();
  v52 = sub_14000BA08(v51);
  do_vmwrite(v39, v40, (unsigned int)v52);
  v53 = sub_140001512();
  v54 = sub_14000BA08(v53);
  do_vmwrite(v39, v40, (unsigned int)v54);
  v55 = sub_14000151A();
  v56 = sub_14000BA08(v55);
  do_vmwrite(v39, v40, (unsigned int)v56);
  v57 = sub_140001522();
  v58 = sub_14000BA08(v57);
  do_vmwrite(v39, v40, (unsigned int)v58);
  v59 = (*(int (**)(void))&byte_140001528[2])();
  v60 = sub_14000BA08(v59);
  do_vmwrite(v39, v40, (unsigned int)v60);
  v61 = sub_1400014F0();
  v62 = sub_14000BA08(v61);
  do_vmwrite(v39, v40, (unsigned int)v62);
  v63 = sub_1400014F9();
  v64 = sub_14000BA08(v63);
  do_vmwrite(v39, v40, (unsigned int)v64);
  v65 = sub_140002F80(0x174u);
  do_vmwrite(v39, v40, v65);
  v66 = sub_140002F80(0x174u);
  do_vmwrite(v39, v40, v66);
  do_vmwrite(v39, v40, v13);
  do_vmwrite(v39, v40, v15);
  do_vmwrite(v39, v40, v14);
  do_vmwrite(v39, v40, v16);
  do_vmwrite(v39, v40, __readcr0());
  do_vmwrite(v39, v40, __readcr3());
  do_vmwrite(v39, v40, __readcr4());
  do_vmwrite(0, 1, 0i64);
  do_vmwrite(0, 1, 0i64);
  do_vmwrite(0, 1, 0i64);
  do_vmwrite(0, 1, 0i64);
  v67 = sub_140002F80(0xC0000100);
  do_vmwrite(v39, v40, v67);
  v68 = sub_140002F80(0xC0000101);
  do_vmwrite(v39, v40, v68);
  v69 = sub_1400014F0();
  v70 = sub_14000BA30(*(__int64 *)((char *)&v90 + 2), v69);
  do_vmwrite(v39, v40, v70);
  v71 = sub_1400014F9();
  v72 = sub_14000BA30(*(__int64 *)((char *)&v90 + 2), v71);
  do_vmwrite(v39, v40, v72);
  do_vmwrite(v39, v40, *(__int64 *)((char *)&v90 + 2));
  do_vmwrite(v39, v40, *(__int64 *)((char *)&v92 + 2));
  do_vmwrite(v39, v40, __readdr(7u));
  do_vmwrite(v39, v40, v87);
  do_vmwrite(v39, v40, v88);
  v73 = __readeflags();
  do_vmwrite(v39, v40, v73);
  v74 = sub_140002F80(0x175u);
  do_vmwrite(v39, v40, v74);
  v75 = sub_140002F80(0x176u);
  do_vmwrite(v39, v40, v75);
  do_vmwrite(v39, v40, __readcr0());
  do_vmwrite(v39, v40, __readcr3());
  do_vmwrite(v39, v40, __readcr4());
  v76 = sub_140002F80(0xC0000100);
  do_vmwrite(v39, v40, v76);
  v77 = sub_140002F80(0xC0000101);
  do_vmwrite(v39, v40, v77);
  v78 = sub_1400014F9();
  v79 = sub_14000BA30(*(__int64 *)((char *)&v90 + 2), v78);
  do_vmwrite(v39, v40, v79);
  do_vmwrite(v39, v40, *(__int64 *)((char *)&v90 + 2));
  do_vmwrite(v39, v40, *(__int64 *)((char *)&v92 + 2));
  v80 = sub_140002F80(0x175u);
  do_vmwrite(v39, v40, v80);
  v81 = sub_140002F80(0x176u);
  do_vmwrite(v39, v40, v81);
  do_vmwrite(v39, v40, v89);
  do_vmwrite(v39, v40, (__int64)sub_1400013E6);
  sub_140004B50((unsigned __int64)&v82 ^ v94);
}
// 1400013E6: using guessed type __int64 __fastcall sub_1400013E6();
// 140002F70: using guessed type int __fastcall MmGetPhysicalAddress(_QWORD);
// 140006028: using guessed type int __fastcall KeGetCurrentProcessorNumberEx(_QWORD);

//----- (000000014000C614) ----------------------------------------------------
__int64 __usercall sub_14000C614@<rax>(__int64 a1@<rax>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __int64 a5@<r10>, __int64 a6@<r11>)
{
  return (unsigned __int8)sub_140001320(
                            a1,
                            a2,
                            (void (__fastcall *)(_QWORD, _QWORD, _QWORD))sub_14000BBCC,
                            a3,
                            a4,
                            a5,
                            a6) == 0 ? 0xC0000001 : 0;
}

//----- (000000014000C638) ----------------------------------------------------
__int64 sub_14000C638()
{
  __int64 result; // rax@1
  unsigned __int64 v1; // [sp+38h] [bp+10h]@2

  result = sub_140002F98();
  if ( (signed int)result >= 0 )
  {
    v1 = __readcr4();
    LODWORD(v1) = v1 & 0xFFFFDFFF;
    __writecr4(v1);
    sub_14000B950(0i64);
    result = 0i64;
  }
  return result;
}

//----- (000000014000D000) ----------------------------------------------------
void __fastcall sub_14000D000(__int64 a1)
{
  __int64 v1; // rdi@1
  char v2; // al@6
  int v3; // eax@8
  int v4; // eax@10
  __int64 v5; // [sp+0h] [bp-158h]@13
  int v6; // [sp+20h] [bp-138h]@1
  unsigned int v7; // [sp+24h] [bp-134h]@2
  unsigned int v8; // [sp+28h] [bp-130h]@4
  __int64 v9; // [sp+140h] [bp-18h]@13

  v6 = 276;
  *(_QWORD *)(a1 + 104) = sub_14000B0C4;
  v1 = a1;
  if ( RtlGetVersion(&v6) >= 0 && (v7 > 6 || v7 == 6 && v8 >= 2) )
  {
    dword_140007308 = 512;
    dword_14000730C = 0x40000000;
  }
  sub_14000D0E4();
  if ( v2 && (signed int)sub_14000D14C() >= 0 )
  {
    sub_14000D180(v1);
    if ( v3 >= 0 )
    {
      sub_14000B73C();
      if ( v4 >= 0 )
      {
        sub_140002F98();
      }
      else
      {
        sub_14000B71C();
        sub_14000B5EC();
      }
    }
    else
    {
      sub_14000B5EC();
      sub_14000B000();
    }
  }
  sub_140004B50((unsigned __int64)&v5 ^ v9);
}
// 140006070: using guessed type int __fastcall RtlGetVersion(_QWORD);
// 140007308: using guessed type int dword_140007308;
// 14000730C: using guessed type int dword_14000730C;

//----- (000000014000D0E4) ----------------------------------------------------
void sub_14000D0E4()
{
  __int64 v0; // [sp+0h] [bp-158h]@1
  char v1; // [sp+20h] [bp-138h]@1
  __int64 v2; // [sp+140h] [bp-18h]@1

  sub_140004C80((signed __int64 *)&v1, 0i64, 0x114ui64);
  RtlGetVersion(&v1);
  sub_140004B50((unsigned __int64)&v0 ^ v2);
}
// 140006070: using guessed type int __fastcall RtlGetVersion(_QWORD);

//----- (000000014000D14C) ----------------------------------------------------
__int64 sub_14000D14C()
{
  void (**i)(void); // rbx@1

  for ( i = (void (**)(void))&unk_140006148; i < (void (**)(void))&unk_140006148; ++i )
    (*i)();
  return 0i64;
}

//----- (000000014000D180) ----------------------------------------------------
void __fastcall sub_14000D180(__int64 a1)
{
  __int64 v1; // rdi@1
  int v2; // ebx@1
  PVOID v3; // rax@4
  void *v4; // rax@6
  unsigned __int64 v5; // rdx@7
  __int64 v6; // rcx@11
  __int64 v7; // [sp+0h] [bp-158h]@13
  int v8; // [sp+20h] [bp-138h]@1
  signed __int64 v9; // [sp+24h] [bp-134h]@1
  unsigned int v10; // [sp+2Ch] [bp-12Ch]@3
  __int64 v11; // [sp+140h] [bp-18h]@13

  v1 = a1;
  v8 = 276;
  sub_140004C80(&v9, 0i64, 0x110ui64);
  v2 = RtlGetVersion(&v8);
  if ( v2 >= 0 )
  {
    if ( (unsigned int)v9 < 0xA || v10 < 0x37EC )
    {
      qword_140008C50 = qword_140007000;
      qword_140008C58 = qword_140007008;
      qword_140008C60 = qword_140007010;
      qword_140008C68 = qword_140007018;
    }
    else
    {
      v3 = sub_14000B6EC(L"MmGetVirtualForPhysical");
      if ( !v3 )
        goto LABEL_13;
      v4 = sub_140002EF8(v3, 0x30ui64, &unk_140006150, 0xAui64);
      if ( !v4 )
        goto LABEL_13;
      qword_140008C68 = *(_QWORD *)((char *)v4 + 10);
      v5 = ((unsigned __int64)qword_140008C68 >> 39) & 0x1FF;
      qword_140008C58 = qword_140008C68 | (v5 << 30) | (v5 << 21);
      qword_140008C50 = qword_140008C58 | (v5 << 12);
      qword_140008C60 = qword_140008C68 | (v5 << 30);
    }
    qword_140008CA0 = 0x7FFFFFFi64;
    qword_140008CA8 = 0xFFFFFFFFFi64;
    qword_140008C88 = 12i64;
    qword_140008C80 = 21i64;
    qword_140008C98 = 0x3FFFFi64;
    qword_140008C90 = 511i64;
    qword_140008C78 = 30i64;
    qword_140008C70 = 39i64;
  }
  if ( v2 >= 0 )
  {
    v6 = **(_QWORD **)(v1 + 40);
    qword_140008C30 = (__int64)sub_140002FE4;
    qword_140008C38 = v6;
    if ( (signed int)sub_14000D36C() >= 0 )
      qword_140008C48 = (int (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))sub_14000B6EC(L"MmAllocateContiguousNodeMemory");
  }
LABEL_13:
  sub_140004B50((unsigned __int64)&v7 ^ v11);
}
// 140002FE4: using guessed type __int64 __fastcall sub_140002FE4();
// 140006070: using guessed type int __fastcall RtlGetVersion(_QWORD);
// 140007000: using guessed type __int64 qword_140007000;
// 140007008: using guessed type __int64 qword_140007008;
// 140007010: using guessed type __int64 qword_140007010;
// 140007018: using guessed type __int64 qword_140007018;
// 140008C30: using guessed type __int64 qword_140008C30;
// 140008C38: using guessed type __int64 qword_140008C38;
// 140008C48: using guessed type int (__fastcall *qword_140008C48)(_QWORD, _QWORD, _QWORD, _QWORD);
// 140008C50: using guessed type __int64 qword_140008C50;
// 140008C58: using guessed type __int64 qword_140008C58;
// 140008C60: using guessed type __int64 qword_140008C60;
// 140008C68: using guessed type __int64 qword_140008C68;
// 140008C70: using guessed type __int64 qword_140008C70;
// 140008C78: using guessed type __int64 qword_140008C78;
// 140008C80: using guessed type __int64 qword_140008C80;
// 140008C88: using guessed type __int64 qword_140008C88;
// 140008C90: using guessed type __int64 qword_140008C90;
// 140008C98: using guessed type __int64 qword_140008C98;
// 140008CA0: using guessed type __int64 qword_140008CA0;
// 140008CA8: using guessed type __int64 qword_140008CA8;

//----- (000000014000D36C) ----------------------------------------------------
signed __int64 sub_14000D36C()
{
  void *v0; // rax@1
  void *v1; // rbx@1
  unsigned int v2; // edi@2
  signed __int64 v3; // r14@2
  signed __int64 v4; // rcx@5
  signed __int64 result; // rax@8
  signed __int64 *v6; // rax@10
  signed __int64 *v7; // rsi@10
  __int64 v8; // r9@12
  char *v9; // r8@12
  char *v10; // rdx@12
  signed __int64 v11; // rcx@13

  LODWORD(v0) = MmGetPhysicalMemoryRanges();
  v1 = v0;
  if ( !v0 )
    return 3221225473i64;
  v2 = 0;
  v3 = 0i64;
  while ( *((_QWORD *)v0 + 2 * v2) || *((_QWORD *)v0 + 2 * v2 + 1) )
  {
    v4 = *((_QWORD *)v0 + 2 * v2 + 1);
    v3 += ((v4 & 0xFFF) != 0) + (v4 >> 12);
    ++v2;
  }
  if ( !v2 || (v6 = (signed __int64 *)ExAllocatePoolWithTag(0, 16 * (v2 - 1 + 2i64), 0x56484C46u), (v7 = v6) == 0i64) )
  {
    ExFreePoolWithTag(v1, 0x68506D4Du);
    return 3221225473i64;
  }
  sub_140004C80(v6, 0i64, 16 * (v2 - 1 + 2i64));
  *(_DWORD *)v7 = v2;
  v7[1] = v3;
  if ( v2 )
  {
    v8 = v2;
    v9 = (char *)((_BYTE *)v1 - (_BYTE *)v7);
    v10 = (char *)(v7 + 2);
    do
    {
      *(_QWORD *)v10 = *(_QWORD *)&v10[(_QWORD)v9 - 16] >> 12;
      v11 = *(_QWORD *)&v10[(_QWORD)v9 - 8];
      v10 += 16;
      *((_QWORD *)v10 - 1) = (v11 >> 12) + ((v11 & 0xFFF) != 0);
      --v8;
    }
    while ( v8 );
  }
  ExFreePoolWithTag(v1, 0x68506D4Du);
  result = 0i64;
  P = v7;
  return result;
}
// 1400060C8: using guessed type int MmGetPhysicalMemoryRanges(void);

//----- (000000014000D49C) ----------------------------------------------------
ULONG_PTR sub_14000D49C()
{
  signed __int64 v0; // rax@1
  unsigned __int64 v1; // rax@3
  ULONG_PTR result; // rax@5

  v0 = _security_cookie;
  if ( !_security_cookie || _security_cookie == 47936899621426i64 )
  {
    v1 = __rdtsc();
    _security_cookie = (unsigned __int64)&_security_cookie ^ (((unsigned __int64)HIDWORD(v1) << 32) | (unsigned int)v1);
    WORD3(_security_cookie) = 0;
    v0 = _security_cookie;
    if ( !_security_cookie )
    {
      v0 = 47936899621426i64;
      _security_cookie = 47936899621426i64;
    }
  }
  result = ~v0;
  BugCheckParameter3 = result;
  return result;
}

// ALL OK, 148 function(s) have been successfully decompiled
