#!/usr/bin/python



import socket
import binascii
import re
import time

s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
#con=('localhost', 1412)
con=('wildwildweb.fluxfingers.net', 1412)
s.connect(con)

def checkit(x):
    s.send(x+'\n')
    while True:
        res=s.recv(1024)
        m1=re.search('Nope', res)
        m2=re.search('Yaaaa', res)
        if m1!=None or m2!=None:
            return m2!=None



diff=0x40
zero='0'
n=50
res='flag{'
charset='0123456789abcdef'


for i in range(len(res), n-1):
    l=''
    for j in range(i):
        l+=binascii.hexlify(res[j])
    r=''
    for j in range(i+1, n):
        r+=zero+chr(0x100-diff+j)

    fd=False
    for guess in charset:
        cur=l+binascii.hexlify(guess)+r
        if checkit(cur):
            res+=guess
            fd=True
            break

    print "ON >> ", i, res
    assert fd
print l


s.send('abc\n')
print s.recv(1024)
print s.recv(1024)
