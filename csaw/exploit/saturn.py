#!/usr/bin/python

import socket
import sys

import binascii



#msg in #0xE(x) -> u32 var10=804a054[x*4],
#if var10!=read() -> exit
#else 804a040[x*4]=1


'''
0x8x
var11=x
var10=word_804a050[x*4]
c=&var10
c+=3
ebx=var10[3]
ecx=var10[2]
edx=var10[1]
eax=var10[0]


'''


def go(diff):
    s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect(('54.85.89.65', 8888))
    s.recv(1024)


    for i in range(8):

        s.send(chr(0xa0+i+diff))
        res=s.recv(1024)
        if len(res)!=4:
            return (False,i)

        s.send(chr(0));

        s.send(chr(0xe0+i))
        #res=res[3]+res[2]+res[1]+res[0]
        s.send(res)



    s.send(chr(0x80))
    return (True,s.recv(1024))



for i in range(0,16):
    res=go(i)
    print res[1]
